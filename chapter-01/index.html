<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<title>Introduction à Node.js</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:initial}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px 0}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:.4em .75em 0 .75em;line-height:1;vertical-align:top}
.colist>table tr>td:first-of-type img{max-width:initial}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
</head>
<body class="book">
<div id="header">
<h1>Introduction à Node.js</h1>
<div class="details">
<span id="revdate">2017-09-06</span>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Node.js génère beaucoup de discussions, d&#8217;intérêts et d&#8217;envies.<br>
Dans ce chapitre, nous allons faire le point sur ce qu&#8217;est Node.js pour mieux comprendre dans quel cambouis nous allons plonger les mains.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="ulist">
<div class="title">Sommaire</div>
<ul>
<li>
<p>Comprendre ce qu&#8217;est Node.js</p>
</li>
<li>
<p>Savoir qui assure la gouvernance de Node.js</p>
</li>
<li>
<p>Décider si Node.js et JavaScript peuvent compléter ou remplacer le langage de programmation de votre entreprise/organisation</p>
</li>
<li>
<p>Pourquoi autant de <em>hype</em> ?</p>
</li>
</ul>
</div>
</div>
</div>
<div class="quoteblock abstract">
<blockquote>
<div class="paragraph">
<p>Node.js est-il un langage de programmation ?
Node.js est-il un <em>framework</em> JavaScript ?
Qu&#8217;en restera-t-il une fois la frénésie retombée ?</p>
</div>
<div class="paragraph">
<p>Ce chapitre n&#8217;est pas essentiel à l&#8217;apprentissage de Node.js.
Il permet de <strong>comprendre pourquoi Node a émergé</strong> et comment.
Surtout, il vous permettra de comprendre les choix techniques à l&#8217;origine des fondations de Node et ce que l&#8217;utiliser peut vous apporter, que ce soit dans un contexte personnel ou professionnel.</p>
</div>
<div class="paragraph">
<p>Qu&#8217;on se le dise : <strong>un langage de programmation en lui-même n&#8217;a jamais résolu quelconque problème</strong>.
Cela reste avant tout une affaire de compétences et d&#8217;expérience, <a href="#avoiding-node">cf. Pourquoi éviter Node ?</a>.</p>
</div>
</blockquote>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Remarque</span> Versions de Node et npm</div>
<div class="paragraph">
<p>Le contenu de ce chapitre se réfère aux versions de <strong>Node v6</strong> et <strong>npm v4</strong>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Remarque</span> Utilisation des exemples</div>
<div class="paragraph">
<p>Les exemples légendés avec un <em>nom de fichier</em> sont disponibles dans le module <em>npm</em> dédié à cet ouvrage.
Ils sont fonctionnels et destinés à être exécutés sur votre ordinateur :</p>
</div>
<div class="listingblock">
<div class="title">Exemple d&#8217;exécution du bloc de code légendé par <code>timeout.js</code>.</div>
<div class="content">
<pre>$ npm install --global nodebook@latest
$ nodebook chapter 1
$ node ./examples/timeout.js</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div id="toc" class="toc">
<div id="toctitle" class="title">Table des matières</div>
<ul class="sectlevel1">
<li><a href="#_node_js_la_plate_forme_javascript_côté_serveur">1. Node.js : la plate-forme JavaScript côté serveur</a></li>
<li><a href="#_historique_du_projet_node_js">2. Historique du projet Node.js</a></li>
<li><a href="#_les_raisons_du_succès">3. Les raisons du succès</a></li>
<li><a href="#_pourquoi_choisir_node_js">4. Pourquoi choisir Node.js ?</a></li>
<li><a href="#avoiding-node">5. Pourquoi éviter Node.js ?</a></li>
<li><a href="#_écosystème">6. Écosystème</a>
<ul class="sectlevel2">
<li><a href="#joyent">6.1. Joyent</a></li>
<li><a href="#node-foundation">6.2. Node.js Foundation</a></li>
<li><a href="#_npm">6.3. npm</a></li>
<li><a href="#npm-inc">6.4. npm, Inc.</a></li>
<li><a href="#iojs">6.5. io.js</a></li>
<li><a href="#_nodejitsu">6.6. Nodejitsu</a></li>
<li><a href="#_node_security_platform">6.7. Node Security Platform</a></li>
<li><a href="#governance">6.8. Qui gère Node.js ?</a></li>
</ul>
</li>
<li><a href="#_architecture_technique">7. Architecture technique</a>
<ul class="sectlevel2">
<li><a href="#_api_node">7.1. API Node</a></li>
<li><a href="#_modules_commonjs">7.2. Modules CommonJS</a></li>
<li><a href="#_interpréteur_node">7.3. Interpréteur Node</a></li>
<li><a href="#v8">7.4. Machine Virtuelle V8</a></li>
<li><a href="#_libuv">7.5. libuv</a></li>
<li><a href="#event-loop">7.6. Boucle événementielle</a></li>
</ul>
</li>
<li><a href="#_philosophie_de_développement">8. Philosophie de développement</a>
<ul class="sectlevel2">
<li><a href="#semver">8.1. Versioning sémantique</a></li>
<li><a href="#node-lifecycle">8.2. Cycle de développement de Node</a></li>
<li><a href="#_node_et_son_api">8.3. Node et son API</a></li>
<li><a href="#_modules_npm">8.4. Modules npm</a></li>
</ul>
</li>
<li><a href="#_conclusion">9. Conclusion</a></li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_node_js_la_plate_forme_javascript_côté_serveur">1. Node.js : la plate-forme JavaScript côté serveur</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Node.js n&#8217;est pas un langage de programmation. Node.js n&#8217;est pas non plus un <em>framework</em> JavaScript. <strong>Node.js est une plate-forme de programmation JavaScript</strong>.<br>
La différence entre ces trois désignations peut sembler subtile, futile voire inutile mais le terme <strong>plate-forme</strong> est la véritable nature de Node.</p>
</div>
<div class="paragraph">
<p><strong>Exécuter du JavaScript côté serveur n&#8217;est pas non plus une révolution</strong>.<br>
L&#8217;entreprise <em>Netscape</em> s&#8217;y est déjà essayée au début des années 1990 avec <em>Netscape Enterprise Server</em>, juste après l&#8217;avoir introduit dans son navigateur web <em>Netscape Navigator</em>.</p>
</div>
<div class="paragraph">
<p>En 1997, <em>Netscape</em> s&#8217;est attelée à créer <em>Rhino</em> (<span class="URL"><a href="https://www.mozilla.org/rhino/" class="bare">www.mozilla.org/rhino/</a></span>), une implémentation de JavaScript en Java disponible sous licence libre.
<em>Rhino</em> était un des projets liés à la réécriture de <em>Netscape Navigator</em> en Java.
Si <em>Netscape</em> a depuis fermé ses portes, <em>Rhino</em> a permis l&#8217;émergence de projets utiles aux développeurs web.</p>
</div>
<div class="paragraph">
<p>Entre temps le langage JavaScript évolue, le <em>Web 2.0</em> émerge des cendres de la première bulle Internet et d&#8217;autres initiatives émergent dans les années 2000 comme <em>APE</em> (<em>Ajax Push Engine</em>, <span class="URL"><a href="http://ape-project.org/" class="bare">ape-project.org/</a></span>).
Elles mettent également en œuvre JavaScript côté serveur.
JavaScript était surtout un choix logique de partage de code entre client et serveur pour Comet, le précurseur des <a href="../chapter-04/index.html#websockets">WebSockets</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Glossaire</span> Comet</div>
<div class="paragraph">
<p><em>Comet</em> est un terme regroupant les différentes tentatives techniques permettant à un serveur web d&#8217;envoyer des données à un client sans que celui-ci ne les ait demandées initialement.</p>
</div>
<div class="paragraph">
<p>Parmi ces techniques, on retrouve le <em>long polling</em>, consistant à conserver une connexion Ajax ouverte pendant la durée de vie d&#8217;une page web.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Glossaire</span> WebSockets</div>
<div class="paragraph">
<p><em>WebSockets</em> est un protocole basé sur TCP.</p>
</div>
<div class="paragraph">
<p>Il permet de maintenir une connexion HTTP active entre un client et un serveur et d&#8217;y faire transiter les données de manière bidirectionnelle.</p>
</div>
<div class="paragraph">
<p>Ce protocole sera probablement rendu obsolète par le successeur d'<em>HTTP/1.1</em>, à savoir <em>HTTP/2</em>.
<em>HTTP/2</em> a été initié par Google en tant que protocole <em>SPDY</em> (prononcer <em>speedy</em>).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Cas d&#8217;utilisation modernes de <em>Rhino</em>.</div>
<div class="paragraph">
<p>Rhino est toujours utile dès qu&#8217;un projet Java implique du JavaScript.</p>
</div>
<div class="paragraph">
<p>Google l&#8217;utilise comme environnement d&#8217;exécution de ses <a href="https://gsuite-developers.googleblog.com/2012/11/using-open-source-libraries-in-apps.html">Apps Scripts</a>.
Ces scripts permettent à tout un chacun de développer des extensions et des interactions supplémentaires pour les documents Google Drive.</p>
</div>
<div class="paragraph">
<p>Rhino est également employé dans <em>yuicompressor</em> (<span class="URL"><a href="https://yui.github.io/yuicompressor/" class="bare">yui.github.io/yuicompressor/</a></span>), un optimiseur CSS et JavaScript créé par Yahoo.
<em>yuicompressor</em> a été surpassé par <em>Closure Compiler</em> (<span class="URL"><a href="https://developers.google.com/closure/compiler/" class="bare">developers.google.com/closure/compiler/</a></span>) et <em>UglifyJS</em> (<span class="URL"><a href="https://npmjs.com/uglify-js" class="bare">npmjs.com/uglify-js</a></span>).
Ce dernier est écrit en JavaScript et repose sur… Node.<br>
La boucle est bouclée.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Node représente un <strong>environnement d&#8217;exécution</strong> (<em>runtime</em>), un <strong>ensemble d&#8217;API JavaScript</strong> ainsi qu&#8217;une <strong>machine virtuelle (VM) JavaScript</strong> performante (parseur, interpréteur et compilateur) pouvant accéder à des ressources système telles que des fichiers (<em>filesystem</em>) ou des connexions réseau (<em>sockets</em>).</p>
</div>
<div class="paragraph">
<p>Typiquement, une personne développant en Node écrit du code se basant sur les API à disposition.
Ce code est lu par le <em>runtime</em> Node qui le transmet à la VM JavaScript. Enfin, la VM traduit le programme en langage machine (<em>bytecode</em>) avant que le programme soit effectivement exécuté par le processeur.</p>
</div>
<div class="paragraph">
<p>Pour comprendre comment Node a opté pour cette approche, retournons en 2009, lorsque son créateur <strong>Ryan Dahl</strong> cherchait à résoudre élégamment un problème de performance de programmation.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_historique_du_projet_node_js">2. Historique du projet Node.js</h2>
<div class="sectionbody">
<div class="paragraph">
<p>En 2006, <em>Ryan Dahl</em> est un étudiant américain en troisième année de doctorat de mathématiques.
Si son but initial était de devenir professeur de mathématiques, il prend la décision de ne pas terminer sa thèse et d&#8217;entreprendre un voyage au Chili.</p>
</div>
<div class="paragraph">
<p>Alors qu&#8217;il cherche à effectuer des petits boulots, il y rencontre une autre personne développant des sites web.
Ruby on Rails connaît un succès grandissant et attire son attention.
Alors que Ryan envisageait d&#8217;utiliser Rails, il découvre avec horreur la lenteur du <em>framework</em> et cherche à en découvrir les causes.</p>
</div>
<div class="paragraph">
<p>Ryan débute alors sa <strong>quête des applications web performantes</strong> et découvre <em>Mongrel</em>, un serveur HTTP écrit en Ruby.
Il est séduit par deux choses :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>la possibilité d'<strong>inclure</strong> un serveur HTTP comme librairie applicative ;</p>
</li>
<li>
<p>la simplicité de fonctionnement : recevoir une requête HTTP et décider soi-même de la réponse à apporter.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>La quête initiale se dirige alors sur la possibilité de créer <strong>un serveur web non bloquant</strong>.
En d&#8217;autres termes, un serveur capable dans un même processus de traiter d&#8217;autres requêtes en attendant de renvoyer la réponse initiale.</p>
</div>
<div class="paragraph">
<p>Nous sommes alors en 2008 et le site de partage de photos Flickr innove avec un nouveau système de téléversement d&#8217;images : une <strong>barre de progression</strong> représentant le statut du téléversement remplace alors la page figée – effet  inhérent à l&#8217;envoi de fichiers depuis un formulaire HTML.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<a class="image" href="https://www.flickr.com/photos/schill/7112862941/"><img src="./images/7112862941_3b8c8e9916_o_d.png" alt="7112862941 3b8c8e9916 o d" width="85%"></a>
</div>
<div class="title">Figure 1. Interface du service Flickr après et avant l&#8217;introduction du téléversement progressif.</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Lien</span> Annonce du nouveau Flickr Uploadr</div>
<div class="paragraph">
<p>L&#8217;équipe d&#8217;ingénierie de Flickr explique comment elle a contourné le problème de l&#8217;upload via un formulaire classique ; problème qui gelait la fenêtre du navigateur pendant la durée du téléversement.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="URL"><a href="https://wp.me/p2DMyG-ok" class="bare">wp.me/p2DMyG-ok</a></span></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>C&#8217;est le <strong>déclic</strong> pour Ryan : <em>Mongrel</em> avait déjà un plug-in pour cette fonctionnalité mais il souhaitait simplifier davantage le travail pour les développeurs.
Il reproduit le mécanisme avec succès en C.
Les développeurs web jugeant la solution trop complexe, Ryan tente la même approche avec d&#8217;autres langages, comme Python, Lua ou même Haskell.
Il se heurte au sempiternel problème des ressources bloquantes des différents interpréteurs.</p>
</div>
<div class="paragraph">
<p>Le deuxième <strong>déclic</strong> se produit en janvier 2009 lorsque <em>JavaScript</em> émerge dans une discussion entre développeurs.
<em>Eurêka</em> !
La machine virtuelle JavaScript V8 de Google a été libérée en <em>open source</em> depuis quelques mois et Apple, Microsoft, Mozilla et Google se livrent à une course à la performance de leur machine virtuelle respective.
En ligne de mire, rendre la navigation sur <em>mobile</em> et sur <em>ordinateur</em> plus rapide et moins gourmande en ressources.</p>
</div>
<div class="paragraph">
<p>Ryan admet que JavaScript dispose des caractéristiques idéales même s&#8217;il n&#8217;est pas un adepte du langage : fonctions anonymes, <em>closures</em> et l'<em>event loop</em> (dans le DOM en tous cas).
Il manque juste aux machines virtuelles JavaScript la capacité d&#8217;accéder à des <em>sockets</em>, au système de fichiers et à d&#8217;autres fonctions système.</p>
</div>
<div class="paragraph">
<p>Ryan quitte alors son travail, s&#8217;inspire de ses travaux de modules non bloquants pour Nginx et s&#8217;affaire pendant six mois à marier JavaScript, V8 et l&#8217;environnement du système d&#8217;exploitation.
De ces efforts naît Node.js.<br>
Il effectue une démonstration de <a href="https://gist.github.com/ry/a3d0bbbff196af633995">serveur IRC écrit en 400 lignes de JavaScript</a> lors de la <a href="https://www.youtube.com/watch?v=ztspvPYybIY">conférence JSConf.eu 2009</a> qui suscite l&#8217;enthousiasme et attire l&#8217;attention.</p>
</div>
<div class="paragraph">
<p>L&#8217;entreprise américaine <em>Joyent</em> l&#8217;embauche à plein temps pour continuer le développement de Node.
Ils pressentent que la plate-forme Node répond à leurs projets de <em>datacenter</em> et d&#8217;hébergement.</p>
</div>
<div class="paragraph">
<p><strong>Node et sa communauté sont nés</strong> et ont continué à prospérer depuis lors.
Pour une simple affaire de <em>barre de progression</em> et une obsession de <em>perception de rapidité</em>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Vidéo</span> <em>History of Node.js</em></div>
<div class="paragraph">
<p>La vidéo suivante est une vidéoconférence donnée par Ryan Dahl, le créateur de Node, au cours de l&#8217;année 2011.
C&#8217;est la première fois qu&#8217;il intervient pour expliquer son parcours et la genèse du projet.</p>
</div>
<div class="paragraph">
<p>Peut-être un élément qui figurera dans les livres d&#8217;histoire !</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="URL"><a href="https://www.youtube.com/watch?v=SAc0vQCC6UQ" class="bare">www.youtube.com/watch?v=SAc0vQCC6UQ</a></span></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_les_raisons_du_succès">3. Les raisons du succès</h2>
<div class="sectionbody">
<div class="paragraph">
<p>En 2009, la tension et l&#8217;attention autour de JavaScript sont énormes.
La mode du tout <em>Ajax</em> et des <em>mashups</em> s&#8217;est estompée mais une chose en est ressortie : JavaScript n&#8217;a plus à rougir ni à être relégué au rang de sous-langage.
Les initiatives JSLint, CommonJS et les <em>good parts</em> de Douglas Crockford sont pour beaucoup dans la création de code élégant.</p>
</div>
<div class="paragraph">
<p>D&#8217;un autre côté, les entreprises développant des navigateurs web se livrent à une féroce compétition d&#8217;optimisation.
Google, Mozilla et Apple ont en effet besoin de navigateurs rapides pour améliorer leurs parts de marché sur les ordinateurs mais aussi les téléphones et tablettes.
On peut considérer que JavaScript est à cette époque le langage de programmation bénéficiant du plus grand investissement financier et humain en R&amp;D.</p>
</div>
<div class="paragraph">
<p>La communauté JavaScript accueille avec ferveur Node lors de la conférence JSConf Europe en 2009.
Elle contribue à son amélioration et à la création d&#8217;un écosystème de modules réutilisables.</p>
</div>
<div class="paragraph">
<p>Il faudra attendre la création du registre <em>npm</em> au tout début 2010 pour faciliter encore plus l&#8217;installation et le partage des modules Node autour du globe.
Dès lors, un simple <code>npm install node-playground</code> suffit pour inclure le module <code>node-playground</code> à son propre projet.
Partager un module est tout aussi simple puisqu&#8217;un simple <code>npm publish</code> le rend disponible à tous en un instant.</p>
</div>
<div class="paragraph">
<p>npm devient une telle pierre angulaire qu&#8217;il est inclus par défaut dans l&#8217;installation de Node à partir de novembre 2011, lors de la publication de Node 0.6.3.
La communauté Node et ses contributeurs ont fait le reste du travail en fournissant un écosystème de modules riche et varié : frameworks, templating, drivers de bases de données, serveurs HTTP, serveurs WebSockets, préprocesseurs CSS, CoffeeScript, parseurs, proxy, serveurs de log, librairies de tests, langages de <em>templating</em>, etc.</p>
</div>
<div class="paragraph">
<p>Malgré ses défauts de jeunesse, Node réussit également le tour de force de la performance : la recette de l&#8217;accès non bloquant aux ressources aurait-elle fonctionné ?
À en croire les personnes ayant migré vers Node pour ces raisons, la réponse est <strong>oui</strong>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_pourquoi_choisir_node_js">4. Pourquoi choisir Node.js ?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Il y a plusieurs raisons d&#8217;utiliser Node, en complément ou en remplacement d&#8217;un langage existant.
Il est préférable que cela soit avant tout une <strong>volonté ou une curiosité et que cela se fasse en considérant la plate-forme Node pour ce qu&#8217;elle est</strong> et non pour ce que vous voudriez qu&#8217;elle soit.</p>
</div>
<div class="paragraph">
<p>Si l&#8217;on tient compte des raisons historiques de la création de Node, il est évident que Node est tout désigné dès lors que l&#8217;on parle d'<strong>applications à nombreuses actions concurrentes</strong>.<br>
Autrement dit, dès que plusieurs requêtes impliquent des accès réseau, aux fichiers ou au système.</p>
</div>
<div class="paragraph">
<p>Grâce aux <em>streams</em>, Node est également un excellent choix pour <strong>travailler et transformer de gros flux de données</strong> en utilisant peu de mémoire.<br>
Cela concerne aussi bien la lecture de fichiers CSV, JSON ou XML de plusieurs giga-octets ou la lecture en continu de l&#8217;API Twitter ou Facebook.</p>
</div>
<div class="paragraph">
<p>La compatibilité de Node avec les modules CommonJS incite à concevoir de multiples modules respectant le <em>principe de responsabilité unique</em>.<br>
Node encourage ainsi à créer de <strong>multiples applications autonomes et modulaires au lieu d&#8217;une seule application monolithique</strong>.</p>
</div>
<div class="paragraph">
<p>Avec Grunt, Gulp, babel, browserify et Webpack, les développeurs verront dans Node leur <strong>compagnon idéal pour compiler, générer, assembler et minifier</strong> leurs différents fichiers.<br>
Le bénéfice évident est le partage du même outillage CSS, JavaScript et HTML entre développeurs, par projet.
Finies les ambiguïtés… et place à l&#8217;automatisation !</p>
</div>
<div class="paragraph">
<p>Conséquence directe du point précédent, Node peut se révéler être une opportunité pour <strong>unifier vos équipes de développement <em>frontend</em> et <em>backend</em></strong>.<br>
Node devient un langage commun entre les individus.
Ils peuvent se focaliser sur des fonctionnalités indistinctement de leur périmètre, qu&#8217;il s&#8217;agisse du navigateur, du serveur ou d&#8217;une API.</p>
</div>
<div class="paragraph">
<p>Enfin, Node est un <strong>environnement adapté à l&#8217;apprentissage et l&#8217;amélioration des connaissances en JavaScript</strong>.<br>
Vous disposez de la maîtrise de la version de Node, des modules employés et n&#8217;avez pas à vous soucier de quelconque compatibilité de version de JavaScript.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="avoiding-node">5. Pourquoi éviter Node.js ?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>S&#8217;il y a des raisons d&#8217;utiliser ou d&#8217;adopter Node, l&#8217;inverse est également vrai.
Il faut toutefois noter que la majorité des raisons sont liées à une <em>culture</em> et des <em>compétences</em> déjà en place dans un environnement donné.</p>
</div>
<div class="paragraph">
<p>Ce serait d&#8217;ailleurs la première et principale raison de ne pas utiliser Node ; si votre équipe dispose déjà de fortes compétences, d&#8217;habitudes et d&#8217;aisance dans un autre langage.<br>
Il n&#8217;y a pas de raison d&#8217;utiliser Node <strong>si vous parvenez à un résultat similaire avec des performances comparables</strong>.</p>
</div>
<div class="paragraph">
<p>L'<strong>offre logicielle est également à prendre en compte</strong> : CMS, systèmes e-commerce ou autre application prête à l&#8217;emploi que la communauté Node n&#8217;offrirait pas.</p>
</div>
<div class="paragraph">
<p>Un facteur important et souvent oublié est <strong>l&#8217;acceptation et la compréhension de l&#8217;utilisation de Node</strong> par une ou plusieurs équipes.
Il est alors plus intéressant de comprendre les raisons d&#8217;un blocage que de forcer ou d&#8217;imposer Node.<br>
Cela peut être simple : balayer des idées reçues, animer un atelier technique ou inviter un expert pour répondre aux questions, interrogations et utilité d&#8217;un tel changement.</p>
</div>
<div class="paragraph">
<p>Node n&#8217;est pas forcément une solution adaptée si <strong>vos besoins de performance dépassent les capacités de Node</strong>. Certains cas de très haute performance nécessitent une gestion fine de la mémoire ou d&#8217;utiliser plusieurs CPU en parallèle.<br>
Un langage comme C sera certainement davantage approprié.
Toutefois des solutions comme <code>node-gyp</code> vous offrent un accès bas niveau aux éléments internes de la plate-forme Node.</p>
</div>
<div class="paragraph">
<p>Node ne vous aidera probablement pas si vous cherchez à <strong>réaliser des choses qui seraient compliquées de par la nature même de JavaScript</strong>, par exemple des opérations mathématiques de très haute précision, du <em>machine learning</em> avancé ou du calcul scientifique poussé.
Difficile d&#8217;égaler la richesse fonctionnelle de Python et de ses librairies SciPy, NumPy ou scikit-learn.<br>
ECMAScript suit le standard IEEE 754 pour la représentation des nombres à virgule flottante — de même que C#, Ruby et Java, entre autres.
Vous pouvez toutefois pallier ce problème via l&#8217;utilisation des <code>Buffer</code> ou des <em>Typed Array</em> (<em>Int32</em>, <em>UInt32</em> etc.).
Les module <code>bignumber.js</code> (<span class="URL"><a href="https://npmjs.com/bignumber.js" class="bare">npmjs.com/bignumber.js</a></span>) et <code>bignum</code> (<span class="URL"><a href="https://npmjs.com/bignum" class="bare">npmjs.com/bignum</a></span>) reposent sur ces mécanismes tout en vous facilitant le travail.</p>
</div>
<div class="paragraph">
<p>Enfin si vous croyez que Node va <strong>résoudre les problèmes par magie</strong> — qu&#8217;ils soient de nature technique, de performance ou de compétences* — c&#8217;est une croyance dont il va falloir se séparer.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_écosystème">6. Écosystème</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Un certain nombre d&#8217;acteurs gravitent autour de Node.
Le modèle qui en émerge est assez unique : la majorité des développements initiaux était financée par <em>Joyent</em> suite à l&#8217;embauche de Ryan Dahl.</p>
</div>
<div class="paragraph">
<p>L&#8217;écosystème contribuant au développement de la plate-forme a évolué d&#8217;un faible nombre d&#8217;entreprises privées vers une fondation non-commerciale impliquant plusieurs dizaines d&#8217;individus, la plupart financés par leur employeur.</p>
</div>
<div class="paragraph">
<p>En 2017, après avoir traversé des périodes incertaines, l&#8217;avenir de Node est au beau fixe avec plus de 1200 contributeurs à la plate-forme et plus de 400 000 paquets publics hébergés sur le registre <em>npm</em>.</p>
</div>
<div class="sect2">
<h3 id="joyent">6.1. Joyent</h3>
<div class="paragraph">
<p>Joyent est une entreprise américaine fondée en 2004.
Elle proposait à l&#8217;origine des services de collaborations en ligne : documents, calendriers, e-mails, etc.</p>
</div>
<div class="paragraph">
<p>Elle se lance sur le marché de l&#8217;hébergement fin 2005 par le biais d&#8217;une acquisition-fusion.
Parmi ses clients, on peut dénombrer le site de Ruby on Rails (société Basecamp), WordPress.com (société Automattic) ou encore le site historique <em>A List Apart</em>.</p>
</div>
<div class="paragraph">
<p>Depuis 2009, Joyent s&#8217;est orienté et s&#8217;est spécialisé dans les infrastructures et plate-formes à la demande et à haute performance.
L&#8217;entreprise se spécialise dans les solutions dites temps réel pour les réseaux sociaux, applications mobiles et compagnies de jeux vidéo en ligne.</p>
</div>
<div class="paragraph">
<p>En avril 2011, Joyent enregistre <em>Node.js</em> et son logo en tant que marque déposée.</p>
</div>
<div class="paragraph">
<p>En février 2015, Joyent transfère la gestion de Node à la <a href="#node-foundation">Node.js Foundation</a>. La société <em>Joyent</em> reste propriétaire de la marque <em>Node.js</em> et de son logo.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Lien</span> Annonce du dépôt de marque</div>
<div class="paragraph">
<p>Ryan Dahl, alors développeur actif de Node, annonce le dépôt de marque par l&#8217;entreprise Joyent sur le blog officiel du projet Node.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="URL"><a href="https://nodejs.org/en/blog/uncategorized/trademark/" class="bare">nodejs.org/en/blog/uncategorized/trademark/</a></span></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a id="node-foundation"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="node-foundation">6.2. Node.js Foundation</h3>
<div class="paragraph">
<p>La <em>Node.js Foundation</em> est l&#8217;organe de gouvernance officiel du projet Node depuis juin 2015.
Il s&#8217;agit d&#8217;une organisation à but non lucratif faisant partie elle-même de la <a href="http://collabprojects.linuxfoundation.org/">Linux Foundation</a>, au même titre que des projets comme <em>Open Container</em>, <em>Let&#8217;s Encrypt</em> ou <em>Xen</em>.</p>
</div>
<div class="paragraph">
<p>La gouvernance de la fondation est effectuée par un comité de direction technique, constitué de membres ayant prouvé une expertise technique dans le <em>design</em> de Node et de sa communauté.</p>
</div>
<div class="paragraph">
<p>La tâche première de la fondation a été d&#8217;opérer la fusion entre la base de code de <em>Node</em> et d'<a href="#iojs">io.js</a>, Node v4.0.0, en septembre 2015.</p>
</div>
</div>
<div class="sect2">
<h3 id="_npm">6.3. npm</h3>
<div class="paragraph">
<p><em>npm</em> est une dénomination qui abrite plusieurs concepts : un <strong>outil en ligne de commande</strong>, un <strong>registre de modules</strong> ainsi qu&#8217;une <strong>entreprise privée</strong>.</p>
</div>
<div class="paragraph">
<p><em>npm</em> est originellement un module Node créé par Isaacs Schlueter.
Ce module permet d&#8217;installer des modules tiers et de les lier sous forme d&#8217;un arbre de dépendances.
Il est l’équivalent de <em>Rubygems</em> (<span class="URL"><a href="https://rubygems.org/" class="bare">rubygems.org/</a></span>) pour Ruby, de <em>CPAN</em> (<span class="URL"><a href="http://www.cpan.org/" class="bare">www.cpan.org/</a></span>) pour Perl ou encore de <em>pypi</em> (<span class="URL"><a href="https://pypi.python.org/pypi" class="bare">pypi.python.org/pypi</a></span>) pour Python.</p>
</div>
<div class="paragraph">
<p>Nous reviendrons plus en détail sur son utilisation dans le <a href="../chapter-02/index.html">chapitre 2 <em>Utiliser des modules tiers</em></a>.</p>
</div>
<div class="paragraph">
<p><em>npm</em> désigne également le <em>registre</em> principal qui héberge les modules des communautés Node : <span class="URL"><a href="https://www.npmjs.com/" class="bare">www.npmjs.com/</a></span>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Lien</span> Annonce de l’inclusion de <em>npm</em> dans Node</div>
<div class="paragraph">
<p><em>npm</em> est installé par défaut avec Node depuis la version 0.6.3, sortie en novembre 2011.
Auparavant, il fallait installer le module <em>npm</em> séparément.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="URL"><a href="https://nodejs.org/en/blog/release/v0.6.3/" class="bare">nodejs.org/en/blog/release/v0.6.3/</a></span></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="npm-inc">6.4. npm, Inc.</h3>
<div class="paragraph">
<p>Isaacs Schlueter a été embauché par Joyent en septembre 2010 et a succédé à Ryan Dahl dans la gestion du projet Node de janvier 2012 jusqu’à janvier 2014.</p>
</div>
<div class="paragraph">
<p><em>npm, Inc</em> est une entreprise privée américaine fondée en janvier 2014 par Isaacs Schlueter, directement après son départ de Joyent. Le but de <em>npm, Inc</em> est de fournir des solutions professionnelles basées sur <em>npm</em> tout en soutenant l’effort open source et les coûts d’infrastructure du registre <em>npm</em>.</p>
</div>
<div class="paragraph">
<p>Elle lève 2,6 millions de dollars en février 2014 pour élaborer une nouvelle architecture du registre <em>npm</em> ainsi que pour mettre en place une stratégie commerciale, notamment les modules privés.</p>
</div>
<div class="paragraph">
<p>La société <em>npm, Inc</em> détient la marque <em>npm</em>, <em>npm, Inc</em> et le <em>logo npm</em>.</p>
</div>
</div>
<div class="sect2">
<h3 id="iojs">6.5. io.js</h3>
<div class="paragraph">
<p><em>io.js</em> est un <em>fork</em> de Node initié par la communauté Node en réaction à la main-mise de Joyent sur le développement et la communication erratique de la plate-forme.</p>
</div>
<div class="paragraph">
<p>Les objectifs initiaux du projet <em>io.js</em> sont doubles :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>offrir à la communauté Node une gestion de la plate-forme transparente, inclusive et ouverte ;</p>
</li>
<li>
<p>fournir une plate-forme technique plus moderne, une version de v8 plus récente ainsi qu&#8217;une intégration rapide des nouvelles fonctionnalités ECMAScript.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Les efforts du projet et de sa communauté ont abouti à la création de la <a href="#node-foundation">Node.js Foundation</a> et du <a href="#governance">Node.js Advisory Board</a>, respectivement l&#8217;organe de gestion du projet et le groupe d&#8217;individus en charge de la gestion du projet Node.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Lien</span> Une fin heureuse pour la communauté</div>
<div class="paragraph">
<p>Le projet <em>io.js</em> s&#8217;arrête en 2015 suite à l&#8217;émergence de la nouvelle gouvernance, de la fusion réussie avec le code source de Node et de la sortie de Node v4.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="URL"><a href="https://nodejs.org/en/blog/announcements/foundation-v4-announce/" class="bare">nodejs.org/en/blog/announcements/foundation-v4-announce/</a></span></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_nodejitsu">6.6. Nodejitsu</h3>
<div class="paragraph">
<p><em>Nodejitsu</em> est une entreprise privée américaine fondée en 2010.
Elle vise à fournir des solutions professionnelles autour de Node en tant que <em>Platform as a Service</em> (<em>PaaS</em>) ainsi qu&#8217;avec des dépôts <em>npm</em> privés.<br>
Son activité en fait un concurrent direct de <a href="#joyent">Joyent</a> et de <a href="#npm-inc">npm, Inc.</a>.</p>
</div>
<div class="paragraph">
<p><em>Nodejitsu</em> démontre un investissement fort dans la communauté Node en contribuant à plusieurs centaines de modules et en prenant en charge l&#8217;hébergement du registre <em>npm</em> de 2010 jusqu&#8217;en décembre 2013.</p>
</div>
<div class="paragraph">
<p>En 2013, <em>Nodejitsu</em> lance l&#8217;initiative controversée <em>scalenpm</em> visant à collecter des fonds pour améliorer la performance et la stabilité du <em>registre npm</em> (<span class="URL"><a href="https://www.npmjs.com/" class="bare">www.npmjs.com/</a></span>).<br>
Elle attise les tensions avec la compagnie <em>npm, Inc.</em> en tentant de lui couper l&#8217;herbe sous le pied, sans succès.</p>
</div>
<div class="paragraph">
<p>En février 2015, la compagnie de vente de noms de domaine et d&#8217;hébergement <em>GoDaddy</em> rachète <em>Nodejitsu</em>, absorbe son équipe et met fin à ses activités commerciales.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Lien</span> La controverse <em>#scalenpm</em></div>
<div class="paragraph">
<p>L&#8217;initiative <em>#scalenpm</em> a réuni quelques 326 000 $ auprès d&#8217;entreprises privées et de la communauté Node.</p>
</div>
<div class="paragraph">
<p>Son effort se poursuit dans le but de fournir une meilleure instrumentation et une architecture résistant à la montée en puissance de l&#8217;utilisation des modules <em>npm</em>.</p>
</div>
<div class="paragraph">
<p>Cette initiative a suscité une controverse dans la mesure où l’opération s’est déroulée lors de la naissance de <em>npm, Inc</em> et du dépôt de marque associé… mais sans entente apparente entre les deux parties.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="URL"><a href="http://web.archive.org/web/20160506191542/https://scalenpm.nodejitsu.com/" class="bare">web.archive.org/web/20160506191542/https://scalenpm.nodejitsu.com/</a></span></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_node_security_platform">6.7. Node Security Platform</h3>
<div class="paragraph">
<p>Le <em>Node Security Platform</em> (<span class="URL"><a href="https://nodesecurity.io/" class="bare">nodesecurity.io/</a></span> — anciennement <em>Node Security Project</em>) est un projet à but lucratif soutenu par la société américaine <em>&amp;yet</em> (<span class="URL"><a href="https://andyet.com/" class="bare">andyet.com/</a></span>).
Il a été initié au début de l&#8217;année 2013.</p>
</div>
<div class="paragraph">
<p>Son but est triple :</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>auditer la sécurité de tous les modules npm ;</p>
</li>
<li>
<p>communiquer les failles auprès des auteurs de modules ;</p>
</li>
<li>
<p>permettre à quiconque de savoir si un module donné dépend de module vulnérable.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Le projet met à disposition des <em>services</em> et des <em>modules</em> tout en cherchant à impliquer la communauté Node dans le processus.
Cela concerne aussi bien la déclaration des vulnérabilités que leur résolution ou l&#8217;éducation des développeurs à la sécurité.</p>
</div>
<div class="paragraph">
<p>Nous apprendrons à protéger nos projects avec <em>Node Security Platform</em> dans la section <a href="../chapter-06/index.html#security">surveiller la santé de l’application</a> du Chapitre 6.</p>
</div>
</div>
<div class="sect2">
<h3 id="governance">6.8. Qui gère Node.js ?</h3>
<div class="paragraph">
<p>Joyent est une entreprise privée qui a été responsable de Node depuis l&#8217;embauche de son créateur — Ryan Dahl —.
Cette gérance privée du projet open source a régulièrement fait grincer des dents, notamment en entretenant un climat d&#8217;incertitude sur la pérennité à long terme de la plate-forme.</p>
</div>
<div class="paragraph">
<p>Certaines voix se sont élevées pour critiquer l&#8217;absence d&#8217;une organisation ouverte, commercialement neutre et ouverte aux contributeurs externes.<br>
C&#8217;est ce qui a poussé <a href="#iojs">io.js</a> a créer un <em>fork</em> de Node, entre autres.</p>
</div>
<div class="paragraph">
<p>Si bien que depuis juin 2015, la gérance du projet est garantie par un organisme commercialement neutre, la <a href="#node-foundation">Node.js Foundation</a>.</p>
</div>
<div class="paragraph">
<p>L&#8217;écosystème de modules <em>npm</em> est quant à lui hébergé sur <em>npmjs.com</em>.
Il sont gratuitement mis à disposition et chaque module est soumis à sa propre licence open source (MIT, Apache 2 etc.).</p>
</div>
<div class="paragraph">
<p>On distingue deux communautés fortes au sein de Node :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>les <strong>contributeurs Node</strong> — essentiellement des <strong>développeurs C++</strong> ;</p>
</li>
<li>
<p>les <strong>contributeurs de <em>modules npm</em></strong> — essentiellement des <strong>développeurs JavaScript</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Intéressons-nous maintenant à l&#8217;architecture technique de la plate-forme Node.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_architecture_technique">7. Architecture technique</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Le terme <em>plate-forme</em> prend tout son sens lorsque l&#8217;on se penche sur l&#8217;architecture de Node.</p>
</div>
<div class="paragraph">
<p>Si on devait la résumer en une phrase : <strong>Node est une API JavaScript pour manipuler des ressources système</strong>.</p>
</div>
<div class="paragraph">
<p>L&#8217;architecture se décompose en plusieurs couches, partant du plus haut niveau (exposées au développeur) et allant jusqu&#8217;au plus bas niveau (exposées au système d&#8217;exploitation) :</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>API Node</p>
</li>
<li>
<p>Interpréteur Node</p>
</li>
<li>
<p>Machine Virtuelle V8</p>
</li>
<li>
<p><em>libuv</em></p>
</li>
<li>
<p>Système d&#8217;exploitation</p>
</li>
</ol>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<a class="image" href="https://twitter.com/busyrich/status/496344440559378432"><img src="./images/event-loop.svg" alt="event loop" width="85%"></a>
</div>
<div class="title">Figure 2. Via <span class="URL"><a href="https://twitter.com/busyrich/status/496344440559378432" class="bare">twitter.com/busyrich/status/496344440559378432</a></span></div>
</div>
<div class="sect2">
<h3 id="_api_node">7.1. API Node</h3>
<div class="paragraph">
<p>L&#8217;API Node correspond à des <em>modules CommonJS</em> écrits en JavaScript (voir ci-après) : client et serveur TCP, accès au système de fichiers, lecture de DNS, streams, buffers etc.</p>
</div>
<div class="paragraph">
<p>Le but de cette API est d&#8217;adresser les manipulations les plus répétitives et pénibles pour les développeurs.
Vous avez déjà cherché à implémenter un client HTTP de zéro ?
Node vous affranchit de cette contrainte en prenant à sa charge ce difficile labeur (car oui, écrire un client HTTP n&#8217;est pas une sinécure !).</p>
</div>
<div class="paragraph">
<p>Ces modules natifs sont relativement bas niveau.
Ils servent de base à la création d&#8217;autres modules plus faciles d&#8217;accès et partagés dans le registre npm.</p>
</div>
<div class="listingblock">
<div class="title">api.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">const fs = require('fs');</code></pre>
</div>
</div>
<div class="paragraph">
<p>Dans cet exemple, la fonction <code>require</code> charge l&#8217;API d&#8217;accès au système de fichier contenue dans le module <code>fs</code>.</p>
</div>
<div class="paragraph">
<p>Le module CommonJS <code>fs</code> expose des fonctions ouvrant l&#8217;accès au système de fichier du système d&#8217;exploitation sur lequel est exécuté le code.</p>
</div>
<div class="paragraph">
<p>Ce code trivial en apparence masque en réalité des milliers de lignes de code écrites en JavaScript et C++.</p>
</div>
</div>
<div class="sect2">
<h3 id="_modules_commonjs">7.2. Modules CommonJS</h3>
<div class="paragraph">
<p>Le projet <em>CommonJS</em> débute en janvier 2009.</p>
</div>
<div class="paragraph">
<p>Pour les membres fondateurs, il était devenu évident que JavaScript allait évoluer dans d&#8217;autres environnements que les seuls navigateurs web.
Il fallait donc trouver un moyen de rendre le code interopérable sur les différentes plates-formes.<br>
Les spécifications les plus notables sont <em>Console</em> et <em>Module</em>.</p>
</div>
<div class="paragraph">
<p>La spécification <em>Module</em> définit entre autres :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>la syntaxe de déclaration d&#8217;un module ;</p>
</li>
<li>
<p>le procédé de chargement d&#8217;un module ;</p>
</li>
<li>
<p>l&#8217;algorithme de résolution d&#8217;un module au sein d&#8217;un arbre de dépendance.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>L&#8217;exemple suivant illustre avec du code ce qu&#8217;est un module CommonJS.</p>
</div>
<div class="listingblock">
<div class="title">increment-module.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">'use strict';

let privateValue = 0;

const incrementValue = () =&gt; privateValue++;

module.exports = incrementValue;</code></pre>
</div>
</div>
<div class="paragraph">
<p>La spécification <em>Module</em> de CommonJS fait usage de la portée lexicale (<em>lexical scope</em>) pour isoler ce qui appartient au module (la variable <code>privateValue</code>) et ce qu&#8217;il expose (une fonction incrémentant et retournant la variable privée).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">const increment = require('./increment-module.js');

increment();    <i class="conum" data-value="1"></i><b>(1)</b>
increment();    <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>retourne <code>1</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>retourne <code>2</code></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Le fonctionnement technique des modules est décrit plus en détail dans le <a href="../chapter-02/index.html">Chapitre 2 : Premiers pas avec Node</a>.</p>
</div>
<div class="paragraph">
<p>L&#8217;essentiel est d&#8217;en retenir que Node se base sur ce mécanisme de chargement de module.
<strong>Ces modules sont une des forces principales de Node</strong>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Lien</span> Site officiel CommonJS</div>
<div class="paragraph">
<p>Le site officiel de CommonJS documente différentes spécifications vouées à promouvoir l&#8217;interopérabilité et la réutilisabilité de JavaScript sur divers environnement d&#8217;exécution.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="URL"><a href="http://www.commonjs.org/" class="bare">www.commonjs.org/</a></span></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_interpréteur_node">7.3. Interpréteur Node</h3>
<div class="paragraph">
<p>L&#8217;interpréteur Node est un programme écrit en C++.</p>
</div>
<div class="paragraph">
<p>L&#8217;interpréteur crée un environnement d&#8217;exécution, initialise la boucle événementielle (<a href="#event-loop"><em>Event Loop</em></a>, voir ci-après), lit le code JavaScript, crée l&#8217;arbre de dépendance des modules puis demande à exécuter le tout.<br>
Il considère l&#8217;exécution terminée lorsque la boucle événementielle n&#8217;a plus d&#8217;instructions à traiter, ni maintenant ni dans le futur.</p>
</div>
<div class="paragraph">
<p>L&#8217;interpréteur s&#8217;arrêtera prématurément si une erreur se déclare et que cette dite erreur n&#8217;est pas prise en charge par le programme.</p>
</div>
<div class="listingblock">
<div class="title">print-date.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">const now = new Date();
console.log(now.toString());</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>node print-date.js <i class="conum" data-value="1"></i><b>(1)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Affiche <code>Fri Apr 04 2014 20:26:46 GMT+0100 (BST)</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Dans cet exemple, l&#8217;interpréteur Node lit le contenu du fichier <code>print-date.js</code>, exécute les deux instructions et s&#8217;arrête dès que les deux instructions sont terminées.</p>
</div>
<div class="paragraph">
<p>La compilation du code est effectuée par la machine virtuelle V8.<br>
La liaison avec le shell système est effectuée par <em>libuv</em>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Lien</span> Code Source de Node</div>
<div class="paragraph">
<p>Le code source de Node est disponible sur GitHub.
Le parcourir permet de mieux comprendre la magie de son fonctionnement… ou d&#8217;avoir subitement mal à la tête !</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="URL"><a href="https://github.com/nodejs/node" class="bare">github.com/nodejs/node</a></span></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="v8">7.4. Machine Virtuelle V8</h3>
<div class="paragraph">
<p>La machine virtuelle V8 est un compilateur JavaScript focalisé sur les performances et la sécurité.
V8 a été créé par Google pour interpréter JavaScript dans son navigateur web Chrome.</p>
</div>
<div class="paragraph">
<p>Node utilise également V8 pour les mêmes raisons : parser, compiler et exécuter JavaScript.
Le résultat de la compilation est retourné sous forme de fonctions et de ressources C++ manipulées par l&#8217;interpréteur Node.</p>
</div>
<div class="paragraph">
<p>Par ricochet, les progrès de V8 impactent directement Node.
Cela concerne aussi bien la prise en charge des nouveautés d&#8217;ECMAScript (version 6, version 7) mais aussi des options et fonctionnalités expérimentales activables à la demande.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Lien</span> Google V8</div>
<div class="paragraph">
<p>Google propose une documentation en ligne du projet V8.
Cette documentation est accompagnée d&#8217;un guide pour intégrer V8 dans d&#8217;autres programmes C++.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="URL"><a href="https://developers.google.com/v8/" class="bare">developers.google.com/v8/</a></span></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_libuv">7.5. libuv</h3>
<div class="paragraph">
<p><em>libuv</em> (<span class="URL"><a href="http://libuv.org/" class="bare">libuv.org/</a></span>) est une librairie C++ focalisée sur l&#8217;accès aux ressources système de manière non bloquante.</p>
</div>
<div class="paragraph">
<p>Cette librairie est compatible avec de nombreux systèmes d&#8217;exploitation comme Windows, Linux ou encore FreeBSD.<br>
D&#8217;autres logiciels sont basés sur <em>libuv</em> mais Node est la première plate-forme à en avoir fait l&#8217;usage… et pour cause, <em>libuv</em> a été créée pour les besoins propres de Node.</p>
</div>
<div class="paragraph">
<p><em>libuv</em> implémente notamment la fameuse boucle événementielle (<a href="#event-loop"><em>Event Loop</em></a>, voir ci-après), la file de priorité (<em>priority queue</em>), délègue les accès réseaux au système d&#8217;exploitation et expose la plupart des fonctions UNIX nécessaires à la manipulation de fichiers et d&#8217;autres actions bas niveau.</p>
</div>
<div class="paragraph">
<p><strong>La performance de Node réside clairement dans <em>libuv</em></strong>.
JavaScript n&#8217;y est pour rien, si ce n&#8217;est à travers la puissance de la machine virtuelle V8.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Lien</span> Code source de <em>libuv</em></div>
<div class="paragraph">
<p>Le code source de <em>libuv</em> est disponible sur GitHub. Le parcourir permet de mieux comprendre les adaptations à chaque système d&#8217;exploitation, par exemple.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="URL"><a href="https://github.com/libuv/libuv" class="bare">github.com/libuv/libuv</a></span></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="event-loop">7.6. Boucle événementielle</h3>
<div class="paragraph">
<p>La boucle événementielle (<em>Event Loop</em>) est un mécanisme d&#8217;exécution des tâches apporté par <em>libuv</em> et déléguée au système d&#8217;exploitation.
Elle s&#8217;inspire très fortement du modèle de boucle événementielle telle qu&#8217;implémentée dans les navigateurs web.</p>
</div>
<div class="paragraph">
<p>C&#8217;est grâce à ce mécanisme que l&#8217;exécution d&#8217;une fonction peut être reportée à plus tard.
C&#8217;est la fameuse <em>exécution asynchrone</em>.</p>
</div>
<div class="listingblock">
<div class="title">timeout.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">const referenceTime = process.hrtime(); <i class="conum" data-value="1"></i><b>(1)</b>
const printT = () =&gt; console.log(process.hrtime(referenceTime)[0]); <i class="conum" data-value="2"></i><b>(2)</b>

printT();                               <i class="conum" data-value="3"></i><b>(3)</b>
setTimeout(printT, 1000);               <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Initialise un temps de référence.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Fonction affichant le nombre de secondes de différence avec le temps de référence à chaque invocation.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Affiche <code>0</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Affiche <code>1</code>, car exécutée <em>une seconde</em> (<em>1000 millisecondes</em>) plus tard.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Dans ce précédent exemple, le code est interprété séquentiellement comme suit.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Assignation de la variable <code>referenceTime</code>.</p>
</li>
<li>
<p>Invocation de la fonction <code>printT</code> (retournant <code>0</code>).</p>
</li>
<li>
<p>Invocation de la fonction <code>console.log</code>.</p>
</li>
<li>
<p>Invocation de la fonction <code>setTimeout</code> : il s&#8217;agit d&#8217;un contrat avec la boucle événementielle d&#8217;exécuter <code>printT</code> dans 1 000 millisecondes.</p>
</li>
<li>
<p>La boucle événementielle continue de tourner car il y a une tâche à traiter.</p>
</li>
<li>
<p>Après avoir tournée pendant 1 000 millisecondes, la boucle dépile une instruction programmée pour cet instant.</p>
</li>
<li>
<p>Invocation de la fonction <code>printT</code> (retournant <code>1</code>).</p>
</li>
<li>
<p>La file de priorité est vide, Node demande au système d&#8217;exploitation d&#8217;arrêter son processus.</p>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Outil</span> Visualiser la boucle</div>
<div class="paragraph">
<p><em>Loupe</em> est un visualisateur de boucle évènementielle.
Écrivez du code et il animera visuellement l&#8217;orchestration de la pile d&#8217;appels, les appels aux API du navigateur ainsi que la pile de callbacks.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="URL"><a href="http://latentflip.com/loupe/" class="bare">latentflip.com/loupe/</a></span></p>
</li>
<li>
<p><span class="URL"><a href="https://github.com/latentflip/loupe" class="bare">github.com/latentflip/loupe</a></span></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Alors pourquoi dit-on que <em>libuv</em> est non bloquant ?
L&#8217;acquisition d&#8217;une ressource système renvoie un descripteur qui est stocké dans une pile d&#8217;exécution dédiée tandis que le processus principal poursuit son propre traitement.<br>
La pile d&#8217;exécution est vérifiée à chaque itération de la boucle — à chaque <em>Tick</em>.
<em>libuv</em> libère la ressource lorsqu&#8217;elle est résolue et le signale au processus principal via un <em>callback</em>.</p>
</div>
<div class="paragraph">
<p>En clair, au lieu de bloquer l&#8217;exécution de l&#8217;instruction suivante, la boucle événementielle reporte la vérification à plus tard et se saisit de l&#8217;instruction suivante.
Et ainsi de suite.</p>
</div>
<div class="paragraph">
<p>On dit également que Node est <em>single threaded</em> car il n&#8217;y a qu&#8217;une seule boucle par processus Node ; processus rattaché à un seul cœur de processeur (<em>CPU core</em>).<br>
Il faut donc lancer d&#8217;autres processus Node sur d&#8217;autres cœurs pour être capable de traiter davantage de données à la fois.
Plusieurs processus Node sur le même cœur se partagent une puissance de calcul finie.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Trivia</span> JavaScript n&#8217;est pas événementiel</div>
<div class="paragraph">
<p>Contrairement à la croyance populaire, <strong>JavaScript n&#8217;a pas de gestion native des événements</strong>.</p>
</div>
<div class="paragraph">
<p>Ce que propose nativement JavaScript, c&#8217;est la facilité de créer des fonctions et d&#8217;encapsuler des contextes via le mécanisme de clôture (<em>closure</em>).
C&#8217;est tout.</p>
</div>
<div class="paragraph">
<p>Tout ce qui est dit <em>asynchrone</em> et <em>événementiel</em> a en réalité rapport à la boucle événementielle et à sa gestion des tâches.</p>
</div>
<div class="paragraph">
<p>Ceci reste valide tant que la boucle événementielle n&#8217;est pas implémentée nativement dans ECMAScript, vraisemblablement dans la version 7 ou 8 du langage.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_philosophie_de_développement">8. Philosophie de développement</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Node a connu une <strong>forte croissance depuis 2012</strong>.
Cela concerne aussi bien le nombre de modules publiés sur le registre npm que le nombre de contributeurs.
C&#8217;est sans compter le nombre d&#8217;articles faisant l&#8217;éloge de la plate-forme et les annonces de migration d&#8217;entreprises vers Node.</p>
</div>
<div class="paragraph">
<p>Il n&#8217;aura fallu que deux ans pour que Node devienne vraiment stable et utilisable en production.</p>
</div>
<div class="sect2">
<h3 id="semver">8.1. Versioning sémantique</h3>
<div class="paragraph">
<p>Le versioning sémantique définit deux concepts importants :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>le principe de <strong>numérotation</strong> de version ;</p>
</li>
<li>
<p>les <strong>plages de compatibilité</strong> de versions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Un numéro de version doit respecter la forme <code>MAJEUR.MINEUR.CORRECTIF</code> (<code>MAJOR.MINOR.PATCH</code>).</p>
</div>
<div class="paragraph">
<p>Si on considère le numéro de version <code>1.0.0</code> :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>1.0.1</code> est une version corrigeant un défaut ;</p>
</li>
<li>
<p><code>1.1.0</code> est une version ajoutant ou modifiant des fonctionnalités mais ne cassant pas la compatibilité avec le reste de la branche <code>1.x.x</code> ;</p>
</li>
<li>
<p><code>2.0.0</code> est une version cassant la compatibilité descendante.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Par convention, les versions <code>0.x.x</code> sont considérées comme des versions <em>instables</em> en préparation d&#8217;une future branche stable (<code>1.x.x</code>).</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Lien</span> Spécification Semver</div>
<div class="paragraph">
<p>La spécification <em>semver</em> est disponible sous forme textuelle mais également en tant que module npm.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="URL"><a href="https://npmjs.com/semver" class="bare">npmjs.com/semver</a></span></p>
</li>
<li>
<p><span class="URL"><a href="http://semver.org/lang/fr/" class="bare">semver.org/lang/fr/</a></span></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>L&#8217;utilisation de certains caractères permet d&#8217;exprimer des <strong>plages de compatibilité</strong>, très utiles lors de l&#8217;installation ou de la mise à jour de modules <em>npm</em> :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>~1.0.0</code> : mises à jour mineures de la branche <code>1.0.0</code> (<code>1.0.1</code>, <code>1.0.2</code> etc.) ;</p>
</li>
<li>
<p><code>1.0.x</code> : idem ;</p>
</li>
<li>
<p><code>^1.0.0</code> : mises à jour mineures et correctives de la branche <code>1.0.0</code> (<code>1.0.1</code>, <code>1.1.0</code>, <code>1.1.1</code> etc.) ;</p>
</li>
<li>
<p><code>1.x.x</code> : idem ;</p>
</li>
<li>
<p><code>&gt;1.0.0</code> : mises à jour majeures, mineures et correctives au-delà de la branche <code>1.0.0</code> (<code>1.0.1</code> mais pas <code>1.0.0</code>, <code>1.1.0</code>, <code>2.0.0</code>, <code>3.1.0</code> etc.) ;</p>
</li>
<li>
<p><code>&gt;1 &lt;3</code> : mises à jour majeures, mineures et correctives entre la branche <code>1.0.0</code> et <code>3.0.0</code> (<code>2.0.0</code>, <code>2.0.1</code>, <code>2.1.0</code> etc.) ;</p>
</li>
<li>
<p><code>&gt;1</code> : mises à jour majeures, mineures et mineures au-delà de la branche <code>1.0.0</code> (<code>2.0.0</code>, <code>2.0.1</code>, <code>3.1.0</code> etc.).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Cette syntaxe est notamment employée pour spécifier les plages de mises à jour  acceptées pour les paquets <code>npm</code>.
Cela permet entre autres de bénéficier de mises à jour de manière consentante (<em>opt-in</em>) à chaque installation ou mise à jour de vos applications.
Vous en apprendrez davantage sur diverses opérations de routine de vos applications dans le <a href="#../chapter-02/index.adoc">chapitre 2</a>, notamment la <a href="../chapter-02/index.html#npm-outdated">vérification de l&#8217;état des dépendances</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Outil</span> Calculateur de version</div>
<div class="paragraph">
<p>Un outil est à disposition pour tester la syntaxe des plages de versions en temps réel sur des données de véritables paquets.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="URL"><a href="https://semver.npmjs.com/" class="bare">semver.npmjs.com/</a></span></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Le mécanisme de versionnement sémantique est appliqué au <a href="#node-lifecycle">cycle de développement de Node</a> depuis la version <code>4.0.0</code> ainsi qu&#8217;aux modules <em>npm</em> – à la discrétion de leurs auteurs.</p>
</div>
<div class="paragraph">
<p>Nous verrons ultérieurement les différentes stratégies de gestion des dépendances <em>npm</em> au sein d&#8217;un projet.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Lien</span> Versioning romantique</div>
<div class="paragraph">
<p>Certaines personnes pensent que l&#8217;aspect <em>sémantique</em> n&#8217;est pas assez clair pour véhiculer l'<em>intention</em> des auteurs quant à la publication d&#8217;une nouvelle version.
Ils en sont venus à proposer plus ou moins sérieusement les notions de <strong>versioning sentimental</strong> et de <strong>versioning romantique</strong>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="URL"><a href="http://dafoster.net/articles/2015/03/14/semantic-versioning-vs-romantic-versioning/" class="bare">dafoster.net/articles/2015/03/14/semantic-versioning-vs-romantic-versioning/</a></span></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="node-lifecycle">8.2. Cycle de développement de Node</h3>
<div class="paragraph">
<p>La vitesse et la croissance sont des facteurs propices à l&#8217;immaturité et à l&#8217;instabilité d&#8217;une plateforme et de son écosystème.</p>
</div>
<div class="paragraph">
<p>Le développement de la plate-forme Node prend en compte ces facteurs afin de <strong>sortir deux versions majeures par année</strong> dont <strong>une version majeure supportée à long terme</strong> (<em>Long Term Support</em>, <em>LTS</em>).</p>
</div>
<div class="paragraph">
<p>La notion de versions supportées à long terme (<em>LTS</em>) a été introduite pour aider à maitriser et anticiper les migrations vers des versions majeures ultérieures.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<a class="image" href="https://github.com/nodejs/LTS/blob/master/schedule.png"><img src="./images/schedule.png" alt="schedule" width="85%"></a>
</div>
</div>
<div class="paragraph">
<p>Les deux versions annuelles suivent un cycle différent :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>versions <strong>paires</strong> (<em>LTS</em>, v4, v6 etc.) :</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>création en <em>avril</em></p>
</li>
<li>
<p>développement actif de <em>six mois</em></p>
</li>
<li>
<p><em>LTS</em> pendant <em>dix-huit mois</em></p>
</li>
<li>
<p>maintenance pendant <em>douze mois</em></p>
</li>
<li>
<p>fin de vie</p>
</li>
</ol>
</div>
</li>
<li>
<p>versions <strong>impaires</strong> (v5, v7 etc.):</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>création en <em>octobre</em></p>
</li>
<li>
<p>développement actif de <em>neuf mois</em></p>
</li>
<li>
<p>fin de vie</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>On remarque que les versions <em>impaires</em> nourissent le développement de la version <em>paire</em> suivante.
Il n&#8217;est pas important de migrer vers celles-ci.
En revanche il est intéressant de garder un œil dessus pour se préparer à l&#8217;arrivée de la version majeure suivante.</p>
</div>
<div class="paragraph">
<p>Cette planification garantit une plate-forme et un ensemble de fonctionnalités stables de manière prédictible, à la fois pour les projets reposant sur Node mais aussi pour l&#8217;écosystème de contributeurs de modules <em>npm</em>.</p>
</div>
<div id="lts" class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">À propos</span> Long Term Support (LTS)</div>
<div class="paragraph">
<p>Le plan de maintenance de Node est maintenu publiquement dans un dépôt GitHub.
Référez-vous à lui pour des informations plus à jour que l&#8217;épreuve papier de cet ouvrage.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="URL"><a href="https://github.com/nodejs/LTS#lts-schedule" class="bare">github.com/nodejs/LTS#lts-schedule</a></span></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_node_et_son_api">8.3. Node et son API</h3>
<div class="paragraph">
<p>Node communique un indice de stabilité pour chacune de ses API publiques selon une échelle discrète graduée de 0 à 5.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="./images/node-api-deprecation.png" alt="node api deprecation" width="85%">
</div>
<div class="title">Figure 3. Example avec l&#8217;api <code>punycode</code>, dont le statut est marqué comme déprécié depuis la v7.</div>
</div>
<div class="paragraph">
<p>Cette échelle se décompose de la manière suivante :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>0 : le module est <strong>déprécié</strong> et peut être supprimé dans une prochaine version majeure ;</p>
</li>
<li>
<p>1 : le module est <strong>expérimental</strong>, instable et nécessite des retours utilisateur ;</p>
</li>
<li>
<p>2 : le module est <strong>instable</strong>, son API peut changer et nécessite davantage de tests grandeur nature avant d&#8217;être considéré comme stable ;</p>
</li>
<li>
<p>3 : le module est <strong>stable</strong> mais peut être sujet à des changements mineurs d&#8217;API ;</p>
</li>
<li>
<p>4 : le module est <strong>gelé</strong>, son API ne devrait plus du tout changer ;</p>
</li>
<li>
<p>5 : le module est <strong>verrouillé</strong>, son code interne ne changera plus.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Ce mécanisme aide au choix des composants pour bâtir des applications robustes ainsi qu&#8217;une estimation de l&#8217;effort de maintenance en cas de changement majeur à venir.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Lien</span> Documentation de l&#8217;API Node</div>
<div class="paragraph">
<p>La documentation de l&#8217;API Node est disponible au format HTML sur le site officiel du projet.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="URL"><a href="https://nodejs.org/api/" class="bare">nodejs.org/api/</a></span></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_modules_npm">8.4. Modules npm</h3>
<div class="paragraph">
<p><strong>Node baigne dans la philosophie UNIX</strong> : le mécanisme de modules incite à suivre le principe de responsabilité unique et de séparation des principes.</p>
</div>
<div class="paragraph">
<p>Cette philosophie encourage la création de petits modules plutôt que de gros monolithes difficilement configurables.</p>
</div>
<div class="paragraph">
<p>Il est possible de publier des modules dans le registre en se basant sur d&#8217;autres modules tiers.
Ils n&#8217;ont pas à avoir connaissance de leur statut de dépendance : ils doivent juste être responsables de leur numérotation de version pour éviter les problèmes de compatibilité.</p>
</div>
<div class="paragraph">
<p>Pour garantir au maximum la stabilité des dépendances, le <em>versioning sémantique</em> aka <em>SemVer</em> a fait son apparition.
Il explicite l&#8217;algorithme employé par <em>npm</em> lors du processus d&#8217;installation et de mise à jour.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conclusion">9. Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Nous venons d&#8217;en apprendre davantage sur les <strong>origines de Node</strong>, les différentes parties prenantes dans son développment mais aussi sa <strong>philosophie</strong> en terme de <em>conception</em>, de <em>distribution</em> et d'<em>évolution</em>.</p>
</div>
<div class="paragraph">
<p>Nous allons voir dans le prochain chapitre comment installer, modifier du code ECMAScript et appeler les principales API de Node.</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2017-09-06 14:02:03 UTC
</div>
</div>
</body>
</html>