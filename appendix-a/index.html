<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<title>Sélection de modules npm</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:initial}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px 0}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:.4em .75em 0 .75em;line-height:1;vertical-align:top}
.colist>table tr>td:first-of-type img{max-width:initial}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
</head>
<body class="book">
<div id="header">
<h1>Sélection de modules npm</h1>
<div class="details">
<span id="revdate">2017-09-06</span>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>L&#8217;écosystème npm regorge de modules.<br>
Comment choisir parmi les centaines de milliers de modules à disposition ?</p>
</div>
<div class="paragraph">
<p>Cette annexe est une sélection subjective de modules npm : vous pouvez
les utiliser les yeux fermés et apprendre à jouer avec Node en toute
confiance.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="ulist">
<div class="title">Sommaire</div>
<ul>
<li>
<p>TBD.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Remarque</span> Versions de Node et npm</div>
<div class="paragraph">
<p>Le contenu de ce chapitre se réfère aux versions de <strong>Node v6</strong> et <strong>npm v4</strong>.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="toc" class="toc">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_modules_de_sécurité_applicative">1. Modules de sécurité applicative</a></li>
<li><a href="#_vérification_syntaxique">2. Vérification syntaxique</a></li>
<li><a href="#_minification_du_code">3. Minification du code</a></li>
<li><a href="#_optimisation_du_code">4. Optimisation du code</a></li>
<li><a href="#_manipulations_diverses">5. Manipulations diverses</a>
<ul class="sectlevel2">
<li><a href="#_lodash">5.1. lodash</a></li>
<li><a href="#_async">5.2. async</a></li>
<li><a href="#_string">5.3. string</a></li>
<li><a href="#_moment">5.4. moment</a></li>
<li><a href="#_eventemitter3">5.5. eventemitter3</a></li>
</ul>
</li>
<li><a href="#_système_de_fichier">6. Système de fichier</a>
<ul class="sectlevel2">
<li><a href="#_mkdirp">6.1. mkdirp</a></li>
<li><a href="#_rimraf">6.2. rimraf</a></li>
<li><a href="#_glob">6.3. glob</a></li>
<li><a href="#_fs_extra">6.4. fs-extra</a></li>
<li><a href="#_graceful_fs">6.5. graceful-fs</a></li>
<li><a href="#_chokidar">6.6. chokidar</a></li>
</ul>
</li>
<li><a href="#_base_de_données">7. Base de données</a>
<ul class="sectlevel2">
<li><a href="#_knex">7.1. knex</a></li>
<li><a href="#_mongoose">7.2. mongoose</a></li>
<li><a href="#_levelup">7.3. levelup</a></li>
<li><a href="#_redis">7.4. redis</a></li>
</ul>
</li>
<li><a href="#_ligne_de_commande">8. Ligne de commande</a>
<ul class="sectlevel2">
<li><a href="#_yargs">8.1. yargs</a></li>
<li><a href="#_chalk">8.2. chalk</a></li>
<li><a href="#_cli_table">8.3. cli-table</a></li>
<li><a href="#_inquirer">8.4. inquirer</a></li>
</ul>
</li>
<li><a href="#_http_et_api">9. HTTP et API</a>
<ul class="sectlevel2">
<li><a href="#_express">9.1. express</a></li>
<li><a href="#_passport">9.2. passport</a></li>
<li><a href="#_restify">9.3. restify</a></li>
<li><a href="#_faye">9.4. faye</a></li>
</ul>
</li>
<li><a href="#_préprocesseurs">10. Préprocesseurs</a>
<ul class="sectlevel2">
<li><a href="#_less">10.1. less</a></li>
<li><a href="#_sass">10.2. sass</a></li>
<li><a href="#_rework">10.3. rework</a></li>
<li><a href="#_browserify">10.4. browserify</a></li>
<li><a href="#_uglify_js">10.5. uglify-js</a></li>
</ul>
</li>
<li><a href="#_templating">11. Templating</a>
<ul class="sectlevel2">
<li><a href="#_swig">11.1. swig</a></li>
<li><a href="#_handlebars">11.2. handlebars</a></li>
<li><a href="#_pug">11.3. pug</a></li>
<li><a href="#_ejs">11.4. ejs</a></li>
<li><a href="#_react">11.5. react</a></li>
</ul>
</li>
<li><a href="#_tests">12. Tests</a>
<ul class="sectlevel2">
<li><a href="#_tape">12.1. tape</a></li>
<li><a href="#_sinon">12.2. sinon</a></li>
<li><a href="#_nyc">12.3. nyc</a></li>
<li><a href="#_karma">12.4. karma</a></li>
<li><a href="#_supertest">12.5. supertest</a></li>
<li><a href="#_eslint">12.6. eslint</a></li>
</ul>
</li>
<li><a href="#_automatisation">13. Automatisation</a>
<ul class="sectlevel2">
<li><a href="#grunt">13.1. grunt</a></li>
<li><a href="#gulp">13.2. gulp</a></li>
<li><a href="#npm-run-all">13.3. npm-run-all</a></li>
</ul>
</li>
<li><a href="#_internet_of_things">14. Internet of Things</a>
<ul class="sectlevel2">
<li><a href="#_nitrogen">14.1. nitrogen</a></li>
<li><a href="#_serialport">14.2. serialport</a></li>
<li><a href="#_firmata">14.3. firmata</a></li>
<li><a href="#_johnny_five">14.4. johnny-five</a></li>
<li><a href="#_cylon">14.5. cylon</a></li>
<li><a href="#_node_red">14.6. node-red</a></li>
</ul>
</li>
<li><a href="#_optimisation_des_images">15. Optimisation des images</a></li>
<li><a href="#_optimisation_des_fontes">16. Optimisation des fontes</a></li>
<li><a href="#_accessibilité">17. Accessibilité</a></li>
<li><a href="#_livereload">18. Livereload</a></li>
<li><a href="#_rendu_graphique">19. Rendu graphique</a>
<ul class="sectlevel2">
<li><a href="#_rendu_2d">19.1. Rendu 2D</a></li>
<li><a href="#_rendu_3d">19.2. Rendu 3D</a></li>
</ul>
</li>
<li><a href="#_rendu_sonore">20. Rendu sonore</a>
<ul class="sectlevel2">
<li><a href="#_codecs">20.1. Codecs</a></li>
<li><a href="#_web_audio">20.2. Web Audio</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_modules_de_sécurité_applicative">1. Modules de sécurité applicative</h2>
<div class="sectionbody">
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Module npm</span> retire.js</div>
<div class="paragraph">
<p><em>retire.js</em> est un module npm permettant de scanner soi-même des vulnérabilités connues dans le code JavaScript de son choix.
Il fonctionne aussi bien pour du JavaScript interprété par un navigateur web que dans Node.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="URL"><a href="https://npmjs.com/retire" class="bare">npmjs.com/retire</a></span></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vérification_syntaxique">2. Vérification syntaxique</h2>
<div class="sectionbody">
<div class="paragraph">
<p>La vérification syntaxique est un mécanisme s&#8217;assurant que votre code respecte la grammaire du langage associé.
Elle peut autant révéler des anomalies fondamentales (balise mal fermée, expression inconnue etc.) que renforcer des pratiques de programmation réduisant les erreurs potentielles lors de l&#8217;exécution du-dit code.</p>
</div>
<div class="paragraph">
<p>Il s&#8217;agit d&#8217;une excellente première étape avant d&#8217;introduire des tests unitaires ou fonctionnels.
C&#8217;est aussi une pratique rapide à mettre en œuvre — de préférence dès le début du projet — et poussant à harmoniser les pratiques de développement au sein d&#8217;un group d&#8217;individus.</p>
</div>
<div class="paragraph">
<p>Les modules à disposition dans npm vous permettront de couvrir vos fichiers CSS, HTML et ECMAScript bien sûr !</p>
</div>
<div class="paragraph">
<p><strong>htmlhint</strong> (<span class="URL"><a href="https://npmjs.com/htmlhint" class="bare">npmjs.com/htmlhint</a></span>) est un outil en ligne de commande vérifiant la structure de vos documents HTML.
Il rapporte les doublons d&#8217;attributs <code>id</code>, la présence de paires de balises mal formées, l&#8217;absence de balise fermante ou encore l&#8217;existance de chaînes de caractère non-imprimables dans des attributs critiques, entre autres.</p>
</div>
<div class="paragraph">
<p>Prenons en exemple le document suivant :</p>
</div>
<div class="listingblock">
<div class="title">sample.html</div>
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;html&gt;
&lt;head&gt;
  &lt;link rel="stylesheet" href="sample.css"&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;button id="btn" class="btn btn-primary"&gt;OK&lt;/button&gt;

  &lt;button id="btn" class="btn"&gt;KO&lt;/button&gt;

  &lt;BUTTON class='btn__primary--curent btn--active'&gt;&lt;/BUTTON&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Une lecture distraite pourrait nous faire passer à côté des erreurs mais également des inconsistances de programmation.
Sur un document plus réaliste et donc volumineux, avec de fréquents changements, autant oublier la vérification manuelle.</p>
</div>
<div class="paragraph">
<p>L&#8217;exécution de <strong>htmlhint</strong> avec ses règles par défaut remontera les alertes suivantes :</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ npm run lint-html
sample.html:
line 1, col 1: Doctype must be first.
line 8, col 10: Id redefinition of [ btn ].
line 10, col 3: Tagname [ BUTTON ] must be lower case.
line 10, col 10: The value of attribute [ class ] must closed by double quotes.
line 10, col 52: Tagname [ BUTTON ] must be lower case.</pre>
</div>
</div>
<div class="paragraph">
<p>Si elle peuvent paraître opiniatres, sachez qu&#8217;elles n&#8217;ont pour seul but que de décider une bonne fois pour toute quelle attitude adopter : tout ou rien en miniscule, guillemets simples ou doubles, doctype explicite etc.</p>
</div>
<div class="paragraph">
<p><strong>eslint</strong> (<span class="URL"><a href="https://npmjs.com/eslint" class="bare">npmjs.com/eslint</a></span>) est l&#8217;outil de vérification syntaxique pour ECMAScript le plus <strong>complet et modulaire</strong>.
Il offre un niveau de souplesse extrême au niveau de la configuration des règles à appliquer (utilisation systématique de <code>use strict</code>, nombre maximum de paramètres de fonctions, objets non-déclarés, variables inconnues etc.).<br>
Il expose également une API relativement simple afin de créer vos propres règles métier.
Un autre mécanisme permet d&#8217;inclure et d&#8217;étendre un ou plusieurs  fichiers de configuration afin de les réutiliser dans différents projets.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Bon à savoir</span> Règles par défaut</div>
<div class="paragraph">
<p><strong>eslint</strong> n&#8217;applique aucune règle par défaut.
Ses premières utilisations nécessiteront donc de prendre connaissance des règles à disposition … ou d&#8217;opter pour un module <em>npm</em> définissant une configuration <em>à votre goût</em>.</p>
</div>
<div class="paragraph">
<p>En effet si certaines règles nous alertent de dangers potentiels, d&#8217;autres sont totalement subjectives et sujettes à des préférences purement personnelles.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>eslint</strong> lit la section <code>eslintConfig</code> du fichier <code>package.json</code> pour adapter son comportement.<br></p>
</div>
<div class="paragraph">
<p>L&#8217;exemple suivant illustre une configuration d'<em>eslint</em> renforçant la déclaration du mode strict au niveau global, l&#8217;emploi des égalités strictes, l&#8217;interdiction de l&#8217;utilisation de variables non déclarées, la cohérence d&#8217;utilisation des accolades ainsi que l&#8217;utilisation de guillemets simples uniquement :</p>
</div>
<div class="listingblock">
<div class="title">package.json</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "name": "nodebook.chapter-04",
  "private": true,
  "dependencies": {
    "eslint": "^1.10.3"
  },
  "...": "...",
  "eslintConfig": {
    "env": {
      "node": true,
      "es6": true
    },
    "rules": {
      "strict": [2, "global"],
      "quotes": [2, "single"],
      "no-undef": 2,
      "curly": 2,
      "eqeqeq": 2
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Le niveau de sévérité de chaque règle peut être configuré à l&#8217;aide d&#8217;un nombre entier :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>0</code> : règle désactivée ;</p>
</li>
<li>
<p><code>1</code> : affiche un avertissement ;</p>
</li>
<li>
<p><code>2</code> : affiche une erreur (le processus se terminera avec un code d&#8217;erreur).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Certaines règles demandent ou acceptent des arguments supplémentaires.
Ces arguments sont documentés dans le répertoire <code>lib/rules</code> de la librairie <em>eslint</em> ainsi que sur le site web du projet (<span class="URL"><a href="http://eslint.org/docs/rules/" class="bare">eslint.org/docs/rules/</a></span>).</p>
</div>
<div class="paragraph">
<p>Il serait fastidieux de répéter ou copier/coller la configuration de projet en projet.
Ça tombe bien, <em>eslint</em> fournit un mécanisme d&#8217;extension.
Ce mécanisme accepte aussi bien des chemins relatifs vers un fichier de configuration mais aussi vers des modules npm.</p>
</div>
<div class="paragraph">
<p>L&#8217;exemple suivant illustre l&#8217;utilisation combinée de deux configurations <em>eslint</em> :</p>
</div>
<div class="listingblock">
<div class="title">package.json</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "name": "nodebook",
  "private": true,
  "dependencies": {
    "eslint": "^1.10.3",
    "eslint-config-airbnb": "^3.1.0",
    "eslint-plugin-react": "^3.15.0"
  },
  "...": "...",
  "eslintConfig": {
    "extends": [
      "airbnb/base",
      "airbnb/rules/react"
    ]
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Il y a deux éléments combinés dans le précédent exemple :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>l&#8217;utilisation d&#8217;un module <em>npm</em> pour obtenir de nouvelles règles — spécifiques à l&#8217;analyse syntaxique d&#8217;applications React ;</p>
</li>
<li>
<p>l&#8217;utilisation d&#8217;un module <em>npm</em> (<em>eslint-config-airbnb</em>) pour configurer <em>eslint</em>, à la fois pour du code à destination de Node, des navigateurs web et de React.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Le détail des règles de configuration mises en application sont disponible simplement en parcourant l&#8217;arborescence du dépôt de code disponible sur <span class="URL"><a href="https://github.com/airbnb/javascript" class="bare">github.com/airbnb/javascript</a></span>.</p>
</div>
<div class="paragraph">
<p><strong>csslint</strong> (<span class="URL"><a href="https://npmjs.com/csslint" class="bare">npmjs.com/csslint</a></span>) est un outil de vérification syntaxique de feuilles de style CSS.
Il a été créé par deux anciens ingénieurs de <em>Yahoo!</em>.
Leurs anciens travaux dans le domaine de la performance ont influencé l&#8217;architecture et le choix des règles par défaut.
Celles-ci peuvent d&#8217;ailleurs être étendues, moins aisément que pour <strong>eslint</strong> certes, mais suffisamment pour adapter l&#8217;outil aux besoins modernes, notamment ceux du web mobile.</p>
</div>
<div class="paragraph">
<p><strong>csslint</strong> fournit les mécanismes de vérification adéquats pour alerter de possibles effets de bord de <em>box model</em>, de déclaration incompatible de <code>@font-face</code>, de <em>vendor prefix</em> dépréciés (voir plus loin la section <em>Optimisation du code</em>) ou encore de combinaisons de propriétés connues pour casser l&#8217;affichage dans certains navigateurs.</p>
</div>
<div class="paragraph">
<p>Prenons par exemple le fichier CSS suivant :</p>
</div>
<div class="listingblock">
<div class="title">sample.css</div>
<div class="content">
<pre class="highlight"><code class="language-css" data-lang="css">.btn {
  background: white;
  color: black;
  border: 0px solid black;
  height: 20px;
  padding: 10px;
}
.btn__primary {
  background-color: blue;
  color: white;
  font-size: 1.3em;
  transition: font-weight 0.2s ease;
}
.btn__primary--current {
  color: gray;
}
.btn__primary--current.btn--active {
  font-weight: 700;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>csslint</strong> génèrera trois alertes en lisant le fichier <code>sample.css</code> et ce, même si celui-ci est syntaxiquement parfaitement valide :</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ csslint sample.css

csslint: There are 3 problems in sample.css.

sample.css
1: warning at line 4, col 11
Values of 0 shouldn't have units specified.
  border: 0px solid black;

sample.css
2: warning at line 4, col 3
Using height with border can sometimes make elements larger than you expect.
  border: 0px solid black;

sample.css
3: warning at line 6, col 3
Using height with padding can sometimes make elements larger than you expect.
  padding: 10px;</pre>
</div>
</div>
<div class="paragraph">
<p>Si la présence d&#8217;une mesure en pixels n&#8217;est qu&#8217;une affaire de micro-optimisation, les deux autres erreurs sont nettement plus problématiques car elles impliquent un manque de consistance d&#8217;affichage, selon le navigateur effectuant le rendu.<br>
Éviter l&#8217;utilisation de ces cas limites évite également d&#8217;avoir à empiler des couches de CSS pouvant accentuer encore peu plus l&#8217;instabilité d&#8217;affichage.</p>
</div>
<div class="paragraph">
<p><strong>doiuse</strong> (<span class="URL"><a href="https://npmjs.com/doiuse" class="bare">npmjs.com/doiuse</a></span>) est un utilitaire qui se repose sur la base de données de <span class="URL">caniuse.com</span>.
Il vous alerte des possibles incompatibilités de syntaxe en fonction de la compatibilité désirée avec une liste de navigateurs web définie par vos soins.
Cette liste peut aussi bien concerner des versions spécifiques ou encore cibler en fonction leurs parts de marché.</p>
</div>
<div class="paragraph">
<p>L&#8217;exemple suivant illustre les alertes relevées par <em>doiuse</em> dans le cas d&#8217;une recherche de compatibilité avec Internet Explorer 6 et Internet Explorer 7 :</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ doiuse -b 'ie &lt; 8' sample.css
sample.css:1:1: CSS 2.1 selectors not supported by: IE (6)
sample.css:8:1: CSS 2.1 selectors not supported by: IE (6)
sample.css:12:1: CSS3 Transitions not supported by: IE (6,7)
sample.css:14:1: CSS 2.1 selectors not supported by: IE (6)</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_minification_du_code">3. Minification du code</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Commentaires, indentations ou encore noms de variables : tout ça occupe de la place, donc des caractères textuels et donc des octets de bande passante.</p>
</div>
<div class="paragraph">
<p>Sans outillage, l&#8217;optimisation repose littéralement entre les mains des développeurs.
Ces derniers doivent alors compromettre lisibilité et maintenabilité au profit de quelques kilo-octets.<br>
Ce que nous chercherons à tout prix à ne pas sacrifier.</p>
</div>
<div class="paragraph">
<p>Les minifieurs mettent en œuvre différentes techniques pour réduire cette occupation d&#8217;espace :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>suppression des commentaires et caractères non-significatifs ;</p>
</li>
<li>
<p>renommage de variables ;</p>
</li>
<li>
<p>factorisation d&#8217;occurences multiples similaires ;</p>
</li>
<li>
<p>suppression des instructions relatives au débogage/développement ;</p>
</li>
<li>
<p>suppression de code mort.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Ces différentes techniques de minification chercherons à préserver l&#8217;intégrité du fonctionnement ou de l&#8217;apparence de vos programmes.
Un avertissement vous préviendra du contraire le cas échéant.</p>
</div>
<div class="paragraph">
<p><strong>cssmin</strong> (<span class="URL"><a href="https://npmjs.com/cssmin" class="bare">npmjs.com/cssmin</a></span>) est un portage ECMAScript du compresseur CSS <em>YUICompressor</em> développé par la compagnie <em>Yahoo!</em> à la fin des années 2000.<br>
L&#8217;approche de <strong>cssmin</strong> consiste principalement à supprimer les caractères et commentaires non-significatifs.
Il ne cherche pas à faire davantage que son homologue originel.</p>
</div>
<div class="paragraph">
<p><strong>cssmin</strong> est donc un outil simple, exposant un exécutable système ainsi qu&#8217;un module Node.
Il ne fournit en revanche aucun support pour les <em>Source Maps</em>. Il vous faudra reposer sur l&#8217;outillage proposé par les navigateurs web modernes pour le débogage (reformatage du code, inspection des propriétés etc.).</p>
</div>
<div class="listingblock">
<div class="title">Exemples d&#8217;utilisation de <strong>cssmin</strong></div>
<div class="content">
<pre>$ cssmin sample.css &gt; sample.min.css <i class="conum" data-value="1"></i><b>(1)</b>

$ cat sample.css | cssmin | wc -c | awk '{print $1}' <i class="conum" data-value="2"></i><b>(2)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Exporte le résultat de la minification dans le fichier <code>sample.min.css</code>;</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Utilisation des <strong>pipes</strong> UNIX pour afficher le nombre de caractères d&#8217;une version minifiée de <code>sample.css</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>UglifyJS</strong> (<span class="URL"><a href="https://npmjs.com/uglify-js2" class="bare">npmjs.com/uglify-js2</a></span>) est un des premiers compresseurs à utiliser une  représentation syntaxique en arbre (<em>Abstract Syntax Tree</em> — <em>AST</em>) en lieu et place des classiques optimisations à coups d&#8217;expressions régulières.</p>
</div>
<div class="paragraph">
<p>Cette méthode permet d&#8217;élargir les perspectives de la compression via de la réécriture de code :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>hoisting</em> des variables (remontée de leur déclaration en début de <em>scope</em>) ;</p>
</li>
<li>
<p>combinaison des déclarations de variables ;</p>
</li>
<li>
<p>factorisation des valeurs de variables ;</p>
</li>
<li>
<p>réécriture partielle d&#8217;expressions ;</p>
</li>
<li>
<p>injection en ligne du contenu de variables.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>UglifyJS</strong> s&#8217;utilise de manière autonome, en ligne de commande ou via son API ECMAScript, mais aussi par le biais de plugins grunt, gulp et <a href="#browserify">browserify</a> (uglifyify et minifyify).<br>
Un exemple plus concret est abordé dans la section <a href="../chapter-05/index.html#automation">automatisation des tâches</a> du chapitre 5.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_optimisation_du_code">4. Optimisation du code</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Parce qu&#8217;optimiser le poids ne suffit pas, certains outils et compresseurs proposent de réécrire une partie de votre code.
Ces optimisations seraient souvent complexes à imaginer et couteuses en temps, à répéter le geste et en maintenance.</p>
</div>
<div class="paragraph">
<p>La majorité des optimiseurs suggérés vous inciteront à suivre la voie des standards.
Vous écrivez du code orienté vers le long terme et les outils se chargent du fardeau de la compatibilité avec le quotidien.<br>
De ce fait, ils ajouteront des instructions relatives à une plus grande compatibilité ou à l&#8217;inverse, ils retireront des portions inutilisées.</p>
</div>
<div class="paragraph">
<p>Quoiqu&#8217;il advienne, en complément des compresseurs ou non, votre code source d&#8217;origine reste intact.
Il est d&#8217;autant plus aisé de les tester, de les activer et de les désactiver quand bon vous semble.</p>
</div>
<div class="paragraph">
<p><strong>autoprefixer</strong> (<span class="URL"><a href="https://npmjs.com/autoprefixer" class="bare">npmjs.com/autoprefixer</a></span>) est <em>le</em> module qui vous épargnera l&#8217;écriture de centaines de lignes en ajoutant automatiquement les bons préfixes aux bons endroits.
Travail d&#8217;autant plus ingrat si vous n&#8217;avez pas envie ni le loisir de recourir à des <em>mixins</em> Less ou Sass.<br>
<em>autoprefixer</em> expose une API ECMAScript, un exécutable système ainsi qu&#8217;une API de <em>streaming</em> permettant une intégration sans plugin avec <a href="#browserify">browserify</a>, entre autres.</p>
</div>
<div class="listingblock">
<div class="title">Exemple d&#8217;utilisation d'<em>autoprefixer</em> en fonction des besoins en compatibilité navigateur</div>
<div class="content">
<pre>$ autoprefixer -o - sample.css | grep transition
  -webkit-transition: font-weight 0.2s ease;
          transition: font-weight 0.2s ease;

$ autoprefixer -b 'firefox &gt; 8' -o - sample.css | grep transition
  -webkit-transition: font-weight 0.2s ease;
     -moz-transition: font-weight 0.2s ease;
          transition: font-weight 0.2s ease;</pre>
</div>
</div>
<div class="paragraph">
<p>L&#8217;exemple précédent illustre comment la propriété <code>transition</code> a été préfixée pour couvrir les navigateurs ayant plus de 1% de part de marché, puis en incluant les versions supérieures à Firefox 8 — assez obsolètes il faut se l&#8217;avouer.<br>
L&#8217;utilisation du paramètre <code>-o -</code> (<em>o</em> pour <em>output</em>) suivi du caractère <em>trait d&#8217;union</em> redirige le code réécrit en <em>sortie standard</em> au lieu de modifier le fichier originel.</p>
</div>
<div class="paragraph">
<p><strong>uncss</strong> (<span class="URL"><a href="https://npmjs.com/uncss" class="bare">npmjs.com/uncss</a></span>) est le pendant inverse d'<em>autoprefixer</em> puisqu&#8217;il se charge de supprimer le code … mort.
Pour se faire, <em>uncss</em> charge une ou plusieurs pages de référence et fait la différence entre les règles CSS utilisées … et celles qui ne le sont pas.
Libre à vous de mentionner une liste blanche de règles à ne jamais supprimer pour éviter qu&#8217;elles soient écrémées par mégarde.</p>
</div>
<div class="paragraph">
<p>Si le monde de l&#8217;optimisation ECMAScript a explosé depuis l&#8217;apparition d'<strong>esprima</strong>, il en est de même pour CSS avec <strong>PostCSS</strong> (<span class="URL"><a href="https://npmjs.com/postcss" class="bare">npmjs.com/postcss</a></span>).<br>
Cet outil est construit autour du triptyque suivant :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>un parseur CSS ;</p>
</li>
<li>
<p>un arbre syntaxique ;</p>
</li>
<li>
<p>un compilateur texte.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Cette combinaison rend possible la production de <em>Source Maps</em> mais aussi la construction d&#8217;une multitude d&#8217;outils destinés à faciliter la vie des développeurs.
Ces outils se greffent sur le parseur, l&#8217;arbre ou le compilateur pour parvenir à leurs fins.<br>
Avec une ou plusieurs extensions, vous avez ainsi accès à <strong>autoprefixer</strong>, à votre nettoyeur de code mort ou même à votre propre réimplémentation de Sass … entièrement en ECMAScript !</p>
</div>
<div class="paragraph">
<p>Enfin, il est bon de savoir que d&#8217;autres outils existent, complètent voire remplacent les compresseurs et optimiseurs précédemment cités :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Google Closure Compiler</strong> (<span class="URL"><a href="https://npmjs.com/closurecompiler" class="bare">npmjs.com/closurecompiler</a></span>)<br>
Un autre compilateur ECMAScript plus poussé qu'<em>UglifyJS</em> mais imposant un style d&#8217;écriture plus strict, voire plus contraignant selon votre style d&#8217;écriture.</p>
</li>
<li>
<p><strong>csswring</strong> (<span class="URL"><a href="https://npmjs.com/csswring" class="bare">npmjs.com/csswring</a></span>)<br>
Une alternative plus moderne que <em>cssmin</em>.
Cet outil s&#8217;interface optionnellement avec <em>PostCSS</em> et offre un support des <em>Source Maps</em>.</p>
</li>
<li>
<p><strong>csso</strong> (<span class="URL"><a href="https://npmjs.com/csso" class="bare">npmjs.com/csso</a></span>)<br>
Une autre alternative à <em>cssmin</em> et <em>csswring</em> écrite par l&#8217;équipe derrière la méthodologie BEM (<span class="URL"><a href="https://en.bem.info" class="bare">en.bem.info</a></span>), moins bien documentée mais plus efficace en terme d&#8217;optimisations.
<em>csso</em> ira jusqu&#8217;à réécrire les codes couleurs, les <code>margin</code> et <code>padding</code> et factorisera les sélecteurs similaires.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_manipulations_diverses">5. Manipulations diverses</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Ces librairies adressent des besoins quotidiens en terme de manipulation de chaînes ou de dates.
Elles vous permettront aussi d&#8217;organiser votre code en exécutant des fonctions de manière séquentielle, parallèle ou en boucles asynchrones.</p>
</div>
<div class="sect2">
<h3 id="_lodash">5.1. lodash</h3>
<div class="paragraph">
<p><em>lodash</em> est une excellente librairie de manipulation de tableaux, d&#8217;objets, de fonctions et de chaînes.</p>
</div>
<div class="paragraph">
<p>Vous pourrez ainsi boucler, filtrer, extraire et composer sans vous soucier de la compatibilité de l&#8217;environnement d&#8217;exécution.</p>
</div>
<div class="paragraph">
<p>Compatible Node et navigateurs Web.<br>
<span class="URL"><a href="https://npmjs.com/lodash" class="bare">npmjs.com/lodash</a></span></p>
</div>
<div class="listingblock">
<div class="title">npm/lodash.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">'use strict';

const { partial, compose } = require('lodash');

const charSplit = (char, string) =&gt; string.split(char);
const mapStringFn = (fn, array) =&gt; {
  return array.map(Function.prototype.call, String.prototype[fn]);
};

const mapUppercase = partial(mapStringFn, 'toLocaleUpperCase');
const mapTrim = partial(mapStringFn, 'trim');
const commaSplit = partial(charSplit, ',');

const splitAndUppercase = compose(mapUppercase, mapTrim, commaSplit);

console.log(splitAndUppercase(' a , b , c , d ')); <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Affiche <code>['A', 'B', 'C', 'D']</code>.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_async">5.2. async</h3>
<div class="paragraph">
<p><em>async</em> est une librairie de gestion de fonctions asynchrones.
Son but ?
Pouvoir itérer sur des tableaux de manière asynchrone, exécuter des <em>callbacks</em> de manière séquentielle ou gérer une pile d&#8217;exécution de <em>n</em> fonctions en parallèle.</p>
</div>
<div class="paragraph">
<p>Compatible Node et navigateurs Web.<br>
<span class="URL"><a href="https://npmjs.com/async" class="bare">npmjs.com/async</a></span></p>
</div>
<div class="listingblock">
<div class="title">npm/async.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">'use strict';

const async = require('async');

const mapStringFn = (fn, array) =&gt; {
  return array.map(Function.prototype.call, String.prototype[fn]);
};

async.waterfall([
  (done) =&gt; done(null, ' a , b , c , d '),
  (string, done) =&gt; done(null, string.split(',')),
  (array, done) =&gt; done(null, mapStringFn('trim', array)),
  (array, done) =&gt; done(null, mapStringFn('toLocaleUpperCase', array)),
], (err, result) =&gt; {
  if (err) {
    return console.error(err);
  }

  console.log(result); <i class="conum" data-value="1"></i><b>(1)</b>
});</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Affiche <code>['A', 'B', 'C', 'D']</code>.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_string">5.3. string</h3>
<div class="paragraph">
<p><em>string</em> est un utilitaire de manipulation de chaînes de caractère.
Le module fournit des méthodes pour échapper, nettoyer, tronquer, remplacer, compter… entre autres.</p>
</div>
<div class="paragraph">
<p>Compatible Node et navigateurs Web.<br>
<span class="URL"><a href="https://npmjs.com/string" class="bare">npmjs.com/string</a></span></p>
</div>
<div class="listingblock">
<div class="title">npm/string.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">'use strict';

const S = require('string');
const title = S('Blog Post');

console.log(title.slugify().s);                   <i class="conum" data-value="1"></i><b>(1)</b>
console.log(title.wrapHTML('h1').s);              <i class="conum" data-value="2"></i><b>(2)</b>
console.log(title.wrapHTML('h1').escapeHTML().s); <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>blog-post</code> ;</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>&lt;h1&gt;Blog Post&lt;/h1&gt;</code> ;</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>&amp;lt;h1&amp;gt;Blog Post&amp;lt;/h1&amp;gt;</code>.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_moment">5.4. moment</h3>
<div class="paragraph">
<p><em>moment</em> est une librairie de gestion de temps.
Elle simplifie énormément le <em>parsing</em> des chaînes, l&#8217;ajout/soustraction de durées et propose des utilitaires de formatage d&#8217;affichage qui vous feront gagner un temps précieux.</p>
</div>
<div class="paragraph">
<p>Compatible Node et navigateurs Web.<br>
<span class="URL"><a href="https://npmjs.com/moment" class="bare">npmjs.com/moment</a></span></p>
</div>
<div class="listingblock">
<div class="title">npm/moment.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">'use strict';

const moment = require('moment');
moment.locale('fr');

const date = moment('11 septembre 2014', 'DD MMMM YYYY');

console.log(date.toISOString());            <i class="conum" data-value="1"></i><b>(1)</b>

date.add(2, 'days').add(5, 'hours');

console.log(date.format('D/MM/YY'));        <i class="conum" data-value="2"></i><b>(2)</b>
console.log(date.from('2014-09-11', true)); <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Affiche <code>2014-09-10T23:00:00.000Z</code> ;</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Affiche <code>13/09/14</code> ;</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Affiche <code>2 jours</code>.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_eventemitter3">5.5. eventemitter3</h3>
<div class="paragraph">
<p><em>eventemitter3</em> est une librairie performante de gestion d&#8217;événements.</p>
</div>
<div class="paragraph">
<p>Compatible Node et navigateurs Web.<br>
<span class="URL"><a href="https://npmjs.com/eventemitter3" class="bare">npmjs.com/eventemitter3</a></span></p>
</div>
<div class="listingblock">
<div class="title">npm/eventemitter3.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">'use strict';

const EventEmitter = require('eventemitter3');
const emitter = new EventEmitter();

emitter.on('ping', pingData =&gt; console.log('on: %s', pingData));
emitter.once('ping', pingData =&gt; console.log('once: %s', pingData));

console.log(emitter.listeners('ping')); <i class="conum" data-value="1"></i><b>(1)</b>

emitter.emit('ping', ['ping', 'ping']); <i class="conum" data-value="2"></i><b>(2)</b>
emitter.emit('ping', ['pong']);         <i class="conum" data-value="3"></i><b>(3)</b>

emitter.removeListener('ping');
emitter.emit('ping', ['pong']);         <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Affiche <code>[ [Function], [Function] ]</code> ;</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Affiche <code>on: ping,ping\nonce: ping,ping</code> ;</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Affiche <code>on: ping,ping</code> ;</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>N&#8217;affiche rien, l&#8217;événement étant désormais déconnecté.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_système_de_fichier">6. Système de fichier</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Ces librairies adressent des besoins quotidiens de manipulation de fichiers, que ce soit leur création, suppression mais aussi leur sélection ou l&#8217;écoute d&#8217;événements liés à ces activités.</p>
</div>
<div class="sect2">
<h3 id="_mkdirp">6.1. mkdirp</h3>
<div class="paragraph">
<p><em>mkdirp</em> est identique à la commande UNIX <code>mkdir -p</code>.
C&#8217;est à dire que les répertoires seront créés récursivement s&#8217;ils n&#8217;existent pas au préalable.</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/mkdirp" class="bare">npmjs.com/mkdirp</a></span></p>
</div>
<div class="listingblock">
<div class="title">npm/mkdirp.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">'use strict';

const mkdirp = require('mkdirp');
const rm = require('rimraf');
const { join } = require('path');
const fs = require('fs');

const filepath = join(__dirname, '..', '..', 'tmp', 'blah', 'blah');

rm(filepath, () =&gt; {
  mkdirp(filepath, err =&gt; {
    if (err) {
      return console.error('Une erreur s\'est produite', err);
    }

    fs.writeFile(join(filepath, 'now.txt'), Date.now());
  });
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>L&#8217;exemple précédent illustre l&#8217;écriture de la date courante dans un fichier.
Ce fichier n&#8217;est écrit que lorsque l&#8217;arborescence est préalablement créée.</p>
</div>
</div>
<div class="sect2">
<h3 id="_rimraf">6.2. rimraf</h3>
<div class="paragraph">
<p><em>rimraf</em> se situe dans la lignée de  <em>mkdirp</em> : il supprime une arborescence de manière récursive — équivalent de la commande <code>rm -rf</code>.
Encore une fois, sans la complexité d&#8217;avoir à gérer un enchevêtrement de fonctions asynchrones.</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/rimraf" class="bare">npmjs.com/rimraf</a></span></p>
</div>
<div class="listingblock">
<div class="title">npm/rimraf.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">'use strict';

const rm = require('rimraf');
const join = require('path').join;

const filepath = join(__dirname, '..', '..', 'tmp');

rm(filepath, err =&gt; {
  if (err) {
    return console.error('Une erreur s\'est produite.', err);
  }
});</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_glob">6.3. glob</h3>
<div class="paragraph">
<p><em>glob</em> est un utilitaire très pratique pour filtrer une recherche récursive au sein du système de fichiers.</p>
</div>
<div class="paragraph">
<p>Sa syntaxe équivalente à ce qui se fait dans le monde UNIX évite une écriture de code complexe reposant sur l&#8217;API <code>fs</code>.</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/glob" class="bare">npmjs.com/glob</a></span></p>
</div>
<div class="listingblock">
<div class="title">npm/glob.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">'use strict';

const glob = require('glob');
const join = require('path').join;

const options = {
  cwd: join(__dirname, '..', '..'),
  ignore: 'node_modules/**'
};

glob('**/cli*.{sh,js}', options, (err, files) =&gt; {
  if (err) {
    return console.error(err);
  }

   console.log(files); <i class="conum" data-value="1"></i><b>(1)</b>
});</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Affiche <code>[ 'examples/npm/cli-table.js' ]</code>.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_fs_extra">6.4. fs-extra</h3>
<div class="paragraph">
<p><em>fs-extra</em> complète <em>rimraf</em> et <em>mkdirp</em> et ajoute d&#8217;autres fonctions utilitaires telles que la copie et le déplacement récursifs.</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/fs-extra" class="bare">npmjs.com/fs-extra</a></span></p>
</div>
<div class="listingblock">
<div class="title">npm/fs-extra.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">'use strict';

const { join } = require('path');
const pify = require('pify');
const fs = pify(require('fs-extra'));

const tmp = join(__dirname, '..', '..', 'tmp');
const dirpath = join(tmp, 'nodebook-examples');

Promise.resolve(tmp)
  .then(tmp =&gt; fs.ensureDir(tmp))
  .then((result) =&gt; result &amp;&amp; console.log('Dossier créé : %s', result))
  .then(() =&gt; fs.remove(dirpath))
  .then(() =&gt; fs.copy(__dirname, dirpath))
  .then(() =&gt; console.log('Dossier copié : %s', dirpath))
  .catch(err =&gt; console.error('Une erreur s\'est produite.', err));</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_graceful_fs">6.5. graceful-fs</h3>
<div class="paragraph">
<p><em>graceful-fs</em> n&#8217;apporte aucune API supplémentaire à l&#8217;API native Node <code>fs</code>.
Sous le capot la librairie simplifie l&#8217;écriture de notre code en tentant plusieurs fois d&#8217;accéder à un fichier si celui-ci n&#8217;est pas disponible.
Un module qui vous sera utile si l&#8217;activité de lecture et d&#8217;écriture sur disque dépasse les capacités du système.</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/graceful-fs" class="bare">npmjs.com/graceful-fs</a></span></p>
</div>
<div class="listingblock">
<div class="title">npm/graceful-fs.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">'use strict';

const fs = require('graceful-fs');
const { join } = require('path');

const filepath = join(__dirname, '..', '..', 'package.json');

fs.readFile(filepath, { encoding: 'utf-8'}, (err, content) =&gt; {
  if (err) {
    return console.error(err);
  }

  console.log(JSON.parse(content).name); <i class="conum" data-value="1"></i><b>(1)</b>
});</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Affiche <code>nodebook.chapter-03</code>.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_chokidar">6.6. chokidar</h3>
<div class="paragraph">
<p><em>chokidar</em> normalise l&#8217;observation du système de fichiers pour une très grande majorité de systèmes d&#8217;exploitation.
La librairie ajoute quelques fonctionnalités de filtre, de persistance d&#8217;observation et permet de dynamiquement ajouter ou retirer des fichiers de l&#8217;observation.</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/chokidar" class="bare">npmjs.com/chokidar</a></span></p>
</div>
<div class="listingblock">
<div class="title">npm/chokidar.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">'use strict';

const chokidar = require('chokidar');
const path = require('path');
const rootDir = path.join(__dirname, '..', '..');

const options = {
  ignoreInitial: true,
  ignored: /node_modules/,
  persistent: true
};

const watcher = chokidar.watch(rootDir, options);

watcher.on('add', filepath =&gt; {
  console.log('add - %s', path.relative(rootDir, filepath));
});
watcher.on('addDir', filepath =&gt; {
  console.log('addDir - %s', path.relative(rootDir, filepath));
});
watcher.on('change', filepath =&gt; {
  console.log('change - %s', path.relative(rootDir, filepath));
});

setTimeout(() =&gt; {
  // eslint-disable-next-line global-require
  require('./mkdirp');

  setTimeout(watcher.close.bind(watcher), 200);
}, 400);</code></pre>
</div>
</div>
<div class="paragraph">
<p>L&#8217;exemple ci-contre surveille un répertoire dans lequel le script <code>npm/mkdirp.js</code> écrit.
Sans surprise, la sortie reflète les actions décrites quelques pages auparavant :</p>
</div>
<div class="listingblock">
<div class="content">
<pre>addDir - tmp
addDir - tmp/blah
addDir - tmp/blah/blah
add - tmp/blah/blah/now.txt</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_base_de_données">7. Base de données</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Node supporte un vaste ensemble de bases de données grâce aux modules npm.
Favorisez toujours les modules faisant état de <em>driver</em> natif/binaire : la communication vers la base de données n&#8217;en sera que plus rapide.</p>
</div>
<div class="sect2">
<h3 id="_knex">7.1. knex</h3>
<div class="paragraph">
<p><em>knex</em> est une librairie de manipulation de base de données SQL.
Elle est notamment compatible avec PostgreSQL, MariaDB, MySQL et SQLite.
Son API fluide basée sur des <em>callbacks</em> et des <em>promesses</em> vous sera précieuse pour ne pas écrire de requête à la main.</p>
</div>
<div class="paragraph">
<p>Les auteurs de <em>knex</em> ont également créé la surcouche <em>bookshelf</em> pour la partie ORM et donc gérer des modèles de données au lieu de requêtes SQL.</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/knex" class="bare">npmjs.com/knex</a></span> et <span class="URL"><a href="https://npmjs.com/bookshelf" class="bare">npmjs.com/bookshelf</a></span>.</p>
</div>
<div class="listingblock">
<div class="title">npm/knex.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">'use strict';

const db = require('knex')({
  client: 'sqlite3',
  connection: {
    // filename: path.join(__dirname, '..', '..', 'db.sqlite')
    filename: ':memory:'
  }
});

db.schema.dropTableIfExists('books')
  .then(() =&gt; {
    return db.schema.createTable('books', table =&gt; {
      table.increments('id').primary();

      table.string('title');
      table.timestamp('created_at').defaultTo(db.raw('CURRENT_TIMESTAMP'));
    });
  })
  .then(() =&gt; {
    return Promise.all([
      db.insert({ title: 'Node.js '}).into('books'),
      db.insert({ title: 'CSS maintenables '}).into('books'),
      db.insert({ title: 'Open Sky'}).into('books')
    ])
  })
  .then(() =&gt; db('books').where('title', 'like', '%Node%'))
  .then(rows =&gt; console.log(rows))
  .then(db.destroy.bind(db));</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Affiche <code>[ { id: 1, title: 'Node.js ', created_at: '2015-10-09 16:06:17' } ]</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>L&#8217;exemple précédent se charge de créer une table dans une base de données SQLite, puis y insère trois nouveaux enregistrements.</p>
</div>
</div>
<div class="sect2">
<h3 id="_mongoose">7.2. mongoose</h3>
<div class="paragraph">
<p><em>mongoose</em> est un <em>ODM</em> (<em>Object Document Model</em>) pour MongoDB.
Il vous aidera à composer vos modèles, gérer la connexion à la base de données mais aussi à définir des comportements annexes comme des mixins ou des <em>accesseurs</em> dynamiques.</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/mongoose" class="bare">npmjs.com/mongoose</a></span></p>
</div>
<div class="listingblock">
<div class="title">npm/mongoose.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">'use strict';

// docker run -ti --rm -p 0.0.0.0:27017:27017 mongo:3.1
// MONGODB_URL=mongodb://192.168.59.103:27017/nodebook node npm-mongoose.js

const mongoose = require('mongoose');
const Schema = mongoose.Schema;

const MONGODB_URL = process.env.MONGODB_URL;

mongoose.connect(MONGODB_URL || 'mongodb://localhost:27017/nodebook');

const BookSchema = new Schema({
  id: Schema.ObjectId,
  title: String,
  created_at: { type: Date, default: Date.now }
});

BookSchema.path('title').set(title =&gt; title.trim());

const Book = mongoose.model('Book', BookSchema);

Promise.all([
  new Book({ title: 'Node.js' }).save(),
  new Book({ title: 'CSS maintenables' }).save(),
  new Book({ title: 'Open Sky' }).save()
])
.then(records =&gt; {
  console.log('%d enregistrements créés.', records.length);   <i class="conum" data-value="1"></i><b>(1)</b>
  mongoose.disconnect();
});</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Affiche <code>3 enregistrements créés</code>.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_levelup">7.3. levelup</h3>
<div class="paragraph">
<p><em>LevelDB</em> est un système de base de données clé/valeur extrêmement modulaire, avec un stockage sur disque par défaut mais pouvant évoluer vers du stockage en mémoire… et dans un contexte de navigateur web !</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/levelup" class="bare">npmjs.com/levelup</a></span></p>
</div>
<div class="listingblock">
<div class="title">npm/levelup.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">'use strict';

const levelup = require('levelup');
const dbPath = require('path').join(__dirname, '..', '..', 'level.db');
const uuid = require('uuid').v4;

const db = levelup(dbPath);

db.batch()
  .put(uuid(), { title: 'Node.js' }, { valueEncoding: 'json' })
  .put(uuid(), { title: 'CSS maintenables' }, { valueEncoding: 'json' })
  .put(uuid(), { title: 'Open Sky' }, { valueEncoding: 'json' })
  .write((err) =&gt; {
    if (err) {
      return console.error(err);
    }

    console.log('Enregistrements créés.');
  });</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_redis">7.4. redis</h3>
<div class="paragraph">
<p><em>redis</em> est une autre base de données clé/valeur focalisée sur la performance et la distribution sur de multiples serveurs.</p>
</div>
<div class="paragraph">
<p><em>hiredis</em> est un <em>driver</em> C++ pouvant être utilisé par le module Node <em>redis</em>.
Il permet de travailler directement avec des buffers plutôt qu&#8217;avec des conversions JSON, ce qui accélère le processus de conversion/déconversion depuis la base de données.</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/redis" class="bare">npmjs.com/redis</a></span> et
<span class="URL"><a href="https://npmjs.com/hiredis" class="bare">npmjs.com/hiredis</a></span></p>
</div>
<div class="listingblock">
<div class="title">npm/redis.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">'use strict';

const client = require('redis').createClient();
const Promise = require('bluebird');
const uuid = require('uuid').v4;

Promise.promisifyAll(client);

Promise.all([
  client.hset(`book:${uuid()}`, 'title', 'Node.js'),
  client.hset(`book:${uuid()}`, 'title', 'CSS maintenables'),
  client.hset(`book:${uuid()}`, 'title', 'Open Sky')
])
.then(() =&gt; {
  console.log('Enregistrements créés.');
  client.end();
});</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ligne_de_commande">8. Ligne de commande</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Nous l&#8217;avions déjà entraperçu dans le chapitre 2 mais Node nous révèle un outillage facilitant les interactions dans un environnement <em>bash</em>.</p>
</div>
<div class="sect2">
<h3 id="_yargs">8.1. yargs</h3>
<div class="paragraph">
<p><em>yargs</em> est une librairie de <em>parsing</em> et de validation d&#8217;arguments.
Elle vous aidera à gérer les valeurs par défaut, à rejeter toute option inconnue ou encore à accumuler les valeurs d&#8217;options identiques.</p>
</div>
<div class="paragraph">
<p>Si seul le <em>parsing</em> vous intéresse, optez pour <em>minimist</em>.</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/yargs" class="bare">npmjs.com/yargs</a></span></p>
</div>
<div class="paragraph">
<p>Référez-vous à la section <em>Approche modulaire</em> de ce même chapitre pour un exemple plus détaillé de cette librairie.</p>
</div>
</div>
<div class="sect2">
<h3 id="_chalk">8.2. chalk</h3>
<div class="paragraph">
<p><em>chalk</em> est un simple outil de colorisation et de mise en forme de texte dans un terminal.
Oubliez les code ANSI, <em>chalk</em> ne vous demandera que deux appels de fonction pour afficher un texte en bleu, italique et souligné !</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/chalk" class="bare">npmjs.com/chalk</a></span></p>
</div>
<div class="listingblock">
<div class="title">npm/chalk.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">'use strict';

const chalk = require('chalk');

const Blue = chalk.blue;
const White = chalk.white;
const Red = chalk.red;

console.log(Blue('Node.js'), White('c\'est'), Red('fantastique !'));</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ce script produira l&#8217;affichage suivant :</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="./images/npm-chalk.png" alt="npm chalk" width="85%">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cli_table">8.3. cli-table</h3>
<div class="paragraph">
<p><em>cli-table</em> est un utilitaire permettant de transformer un tableau de primitives ou d&#8217;objets ECMAScript en un tableau visuel dans le terminal.
Des options vous permettent de gérer la ligne d&#8217;entête et la largeur des colonnes, entre autres.</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/cli-table" class="bare">npmjs.com/cli-table</a></span></p>
</div>
<div class="listingblock">
<div class="title">npm/cli-table.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">'use strict';

const CliTable = require('cli-table');
const pkg = require('../../package.json');
const table = new CliTable({
  head: ['Module', 'Version']
});

const modules = Object.keys(pkg.dependencies).map((moduleName) =&gt; {
  return [moduleName, pkg.dependencies[moduleName]];
});

table.push(...modules);

console.log(table.toString());</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ce script produira l&#8217;affichage suivant :</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="./images/npm-cli-table.png" alt="npm cli table" width="85%">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_inquirer">8.4. inquirer</h3>
<div class="paragraph">
<p><em>inquirer</em> est le composant qu&#8217;il vous faut pour gérer l&#8217;interactivité avec un utilisateur dans le terminal : questions à choix multiple, validation de saisie, texte libre multiple etc.</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/inquirer" class="bare">npmjs.com/inquirer</a></span></p>
</div>
<div class="listingblock">
<div class="title">npm/inquirer.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">'use strict';

const inquirer = require('inquirer');
const sanitize = require('sanitize-filename');

inquirer.prompt({
  name: 'fav-module',
  message: 'Quel module natif Node souhaitez-vous mieux maitriser ?',
  filter: (input) =&gt; sanitize(input),
  validate: (input) =&gt; {
    try {
      // eslint-disable-next-line global-require
      require(sanitize(input));
      return true;
    }
    catch (e){
      return false;
    }
  }
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>Le programme précédent tente de charger le module Node saisi par l&#8217;utilisateur et rejette la réponse s&#8217;il n&#8217;existe pas.</p>
</div>
<div class="paragraph">
<p>La saisie est préalablement nettoyée pour éviter que le chargement d&#8217;un module local puisse aboutir.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_http_et_api">9. HTTP et API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Une majorité d&#8217;articles et de tutoriaux pour Node ont pour habitude d&#8217;illustrer la création d&#8217;un serveur HTTP.
S&#8217;il est vrai que Node rend les interactions réseaux aisées grâce à leur gestion non-bloquante, créer un serveur respectant réellement la spécification du protocole HTTP est une autre paire de manches.</p>
</div>
<div class="paragraph">
<p>La plupart des modules n&#8217;imposant pas de choix d&#8217;architecture, vous aurez souvent à composer vous-même votre application HTTP en fonction de vos besoins.</p>
</div>
<div class="sect2">
<h3 id="_express">9.1. express</h3>
<div class="paragraph">
<p><em>express</em> est probablement la librairie la plus populaire.
Elle gère le routage HTTP et la passation de données vers le moteur de rendu de votre choix.
Son système de <em>middlewares</em></p>
</div>
<div class="paragraph">
<p>Peu d&#8217;aspects de sécurité sont pris en charge.
Il est fortement recommandé de lui adjoindre <em>helmet</em> ou d&#8217;opter pour <em>kraken</em>, une surcouche d'<em>express</em> configurée dans cette optique.</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/express" class="bare">npmjs.com/express</a></span>, <span class="URL"><a href="https://npmjs.com/helmet" class="bare">npmjs.com/helmet</a></span> et <span class="URL"><a href="https://npmjs.com/kraken-js" class="bare">npmjs.com/kraken-js</a></span></p>
</div>
<div class="paragraph">
<p>Référez-vous à la section <em>Approche modulaire</em> de ce même chapitre pour un exemple plus détaillé de cette librairie.</p>
</div>
</div>
<div class="sect2">
<h3 id="_passport">9.2. passport</h3>
<div class="paragraph">
<p><em>passport</em> est une librairie de gestion d&#8217;authentification.
De nombreux modules complémentaires permettent de gérer une authentification par mot de passe, par OAuth, par compte Google Apps etc.</p>
</div>
<div class="paragraph">
<p>Elle fonctionne particulièrement bien puisqu&#8217;elle n&#8217;impose pas de mécanisme de persistence d&#8217;utilisateurs ni de session.</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/passport" class="bare">npmjs.com/passport</a></span></p>
</div>
<div class="paragraph">
<p>Référez-vous à sa documentation pour des exemples détaillés d&#8217;utilisation et d&#8217;implémentation au sein de votre application.</p>
</div>
</div>
<div class="sect2">
<h3 id="_restify">9.3. restify</h3>
<div class="paragraph">
<p><em>restify</em> est une alternative à <em>express</em> si votre application n&#8217;a pour seul but que d&#8217;exposer une API REST, sans rendu HTML ou nécessitant un templating particulier.</p>
</div>
<div class="paragraph">
<p>Elle rend possible le débogage complet à partir de <em>dtrace</em>, la gestion des versions d&#8217;API et expose un client permettant de consommer des données sur d&#8217;autres API REST.</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/restify" class="bare">npmjs.com/restify</a></span></p>
</div>
<div class="listingblock">
<div class="title">npm/restify.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">'use strict';

const restify = require('restify');
const server = restify.createServer();
const { dependencies } = require('../../package.json');

const validate = (req, res, next) =&gt; {
  if (!(req.params.name in dependencies)){
    return next(restify.ResourceNotFoundError('Module not found'));
  }

  next();
};

const responseV1 = (req, res, next) =&gt; {
  res.send(200, dependencies[req.params.name]);

  next();
};

const responseV2 = (req, res, next) =&gt; {
  res.send(200, {
    modules: [{
      name: req.params.name,
      version: dependencies[req.params.name].slice(1)
    }]
  });

  next();
};

server.use(restify.CORS());
server.get({ path: '/modules/:name', version: '1.0.0' }, validate, responseV1);
server.get({ path: '/modules/:name', version: '2.0.0' }, validate, responseV2);

server.listen(8080, () =&gt; console.log('Serveur accessible sur %s', server.url));</code></pre>
</div>
</div>
<div class="paragraph">
<p>L&#8217;exemple précédent expose une même route permettant d&#8217;obtenir des informations sur les déclarations de versions d&#8217;un fichier <code>package.json</code>.</p>
</div>
<div class="paragraph">
<p>Par défaut, la version 2 de l&#8217;API est utilisée :</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl http://localhost:8080/modules/express
{"modules":[{"name":"express","version":"4.9.5"}]}</pre>
</div>
</div>
<div class="paragraph">
<p>Une version obsolète de l&#8217;API peut toutefois être utilisée si l&#8217;on mentionne explicitement cette information :</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl -H 'Accept-version: ~1' http://localhost:8080/modules/express
"^4.9.5"</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_faye">9.4. faye</h3>
<div class="paragraph">
<p><em>faye</em> est à la fois un serveur et un client de communication en temps réel entre un client et un serveur.
Il utilisera WebSocket, Ajax ou JSON-P selon les capacités technologiques du client.</p>
</div>
<div class="paragraph">
<p>Compatible Node et navigateurs Web.<br>
<span class="URL"><a href="https://npmjs.com/faye" class="bare">npmjs.com/faye</a></span> et <span class="URL"><a href="https://npmjs.com/socket.io" class="bare">npmjs.com/socket.io</a></span></p>
</div>
<div class="listingblock">
<div class="title">npm/faye.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">'use strict';

const http = require('http');
const faye = require('faye');

const ws = new faye.NodeAdapter({ mount: '/realtime', timeout: 10 });

const server = http.createServer((req, res) =&gt; {
  res.writeHead(200, { 'Content-Tyoe': 'text/plain' });
  res.end('Contenu non temps réel');
});

ws.attach(server);
server.listen(3000);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ce serveur extrêmement minimaliste expose un point d&#8217;entrée qui peut être accédé via le client <em>Faye</em>, dans un navigateur web ou via un autre script Node.</p>
</div>
<div class="paragraph">
<p>Tout message émit par un client sera relayé auprès des autres clients connectés.
Un mécanisme de canaux et d&#8217;authentification vous permettra de canaliser les messages en fonction des besoins de votre application.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_préprocesseurs">10. Préprocesseurs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Les préprocesseurs sont des outils de productivité transformant un langage vers un autre langage, en général compatible avec une majorité de navigateurs.</p>
</div>
<div class="paragraph">
<p>Certains vous permettront même de compiler du code Node vers du code compatible avec un navigateur Web.</p>
</div>
<div class="sect2">
<h3 id="_less">10.1. less</h3>
<div class="paragraph">
<p><em>less</em> est un préprocesseur permettant de compiler vers du code CSS.
Ses atouts résident dans la gestion des variables, de <em>mixins</em> et de fonctions encourageant une écriture modulaire, plus logique et plus succincte.</p>
</div>
<div class="paragraph">
<p>Compatible Node et navigateurs Web.<br>
<span class="URL"><a href="https://npmjs.com/less" class="bare">npmjs.com/less</a></span></p>
</div>
<div class="listingblock">
<div class="title">stylesheet.less</div>
<div class="content">
<pre class="highlight"><code>@warning-color: red;
@base-font-size: 18px;

.btn {
  border: 1px solid black;
  border-radius: @base-font-size / 6;
  font-size: @base-font-size;

  &amp;--large {
    font-size: @base-font-size * 1.5;
  }

  &amp;--warning {
    border-color: fadeout(@warning-color, 10%);
    color: @warning-color;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>L&#8217;exécutable <code>lessc</code> compile le fichier LESS:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>lessc stylesheet.less</pre>
</div>
</div>
<div class="paragraph">
<p>La sortie de la commande précédente génère ce résultat :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-css" data-lang="css">.btn {
  border: 1px solid black;
  border-radius: 3px;
  font-size: 18px;
}
.btn--large {
  font-size: 27px;
}
.btn--warning {
  border-color: rgba(255, 0, 0, 0.9);
  color: #ff0000;
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sass">10.2. sass</h3>
<div class="paragraph">
<p>Sass est un autre préprocesseur populaire issu du monde Ruby.
Un portage en C++ est disponible via le module <em>node-sass</em> et ne requiert pas l&#8217;installation de Ruby.</p>
</div>
<div class="paragraph">
<p>Compatible Node.<br>
<span class="URL"><a href="https://npmjs.com/node-sass" class="bare">npmjs.com/node-sass</a></span> et <span class="URL"><a href="http://sass-lang.com/libsass" class="bare">sass-lang.com/libsass</a></span></p>
</div>
</div>
<div class="sect2">
<h3 id="_rework">10.3. rework</h3>
<div class="paragraph">
<p><em>rework</em> est une alternative à Less et Sass dans le sens où vous définissez les règles de votre préprocesseur… y compris si cela revient à écrire vos propres règles.</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/rework" class="bare">npmjs.com/rework</a></span></p>
</div>
<div class="paragraph">
<p>Par défaut <em>rework</em> ne fournit qu&#8217;un lot réduit de fonctionnalités.
Il faut donc rajouter des extensions pour étendre le comportement et modeler le <em>parsing</em> à notre goût.</p>
</div>
<div class="listingblock">
<div class="title">npm/rework.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">'use strict';

const rework = require('rework');
const fs = require('fs');
const { join } = require('path');

const colors = require('rework-plugin-colors');
const whitespace = require('css-whitespace');
const vars = require('rework-vars');
const math = require('rework-math');

fs.readFile(join(__dirname, '..', 'stylesheet.css'), (err, binaryContent) =&gt; {
  if (err) {
    // ...
  }

  const textContent = whitespace(String(binaryContent));
  const r = rework(textContent, { source: 'stylesheet.css' })
    .use(vars())
    .use(math())
    .use(colors());

  console.log(r.toString());
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>Cette configuration permet de parser la feuille de style suivante :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>:root
  --warning-color: red
  --base-font-size: 18px

.btn
  border: 1px solid black
  border-radius: math(var(--base-font-size) / 6)
  font-size: var(--base-font-size)

.btn--large
  font-size: math(var(--base-font-size) * 1.5)

.btn--warning
  border-color: rgba(var(--warning-color), 0.9)
  color: var(--warning-color)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Le résultat à l&#8217;issu de la compilation est identique à la sortie du module <em>less</em>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_browserify">10.4. browserify</h3>
<div class="paragraph">
<p><em>browserify</em> transforme des modules CommonJS et des appels aux API Node en un code ECMAScript capable d&#8217;être exécuté dans un navigateur Web.</p>
</div>
<div class="paragraph">
<p>Un puissant mécanisme de <em>transforms</em> introduit des remplacements de modules à la volée ou le mélange de modules AMD et CommonJS.</p>
</div>
<div class="paragraph">
<p>Une alternative à <em>browserify</em> est <em>webpack</em>.
Aux fonctionnalités précédemment listées s&#8217;ajoutent une prise en charge plus aisée de multiples modules ainsi que la compilation de fichiers CSS ou Less.</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/browserify" class="bare">npmjs.com/browserify</a></span> et <span class="URL"><a href="https://npmjs.com/webpack" class="bare">npmjs.com/webpack</a></span></p>
</div>
<div class="listingblock">
<div class="title">npm/browserify.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">'use strict';

const $ = require('cheerio');

const $list = $('&lt;ul/&gt;');

$list.append('&lt;li&gt;Node.js&lt;/li&gt;');
$list.append('&lt;li&gt;CSS maintenables&lt;/li&gt;');
$list.append('&lt;li&gt;Open Sky&lt;/li&gt;');

console.log($list.find('li:last-child').text()); <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Affiche <code>Open Sky</code>.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">package.json</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">{
  "browser": {
    "cheerio": "jquery"
  },
  "dependencies": {
    "cheerio": "^0.17.0",
    "jquery": "^2.1.1",
  },
  "devDependencies": {
    "browserify": "^5.0.0"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>La commande <code>browserify</code> remplacera l&#8217;appel au module <em>cheerio</em> par un appel au module <em>jquery</em> :</p>
</div>
<div class="listingblock">
<div class="content">
<pre>browserify npm/browserify.js -o npm/browserify.bundle.js</pre>
</div>
</div>
<div class="paragraph">
<p>Inclus dans un navigateur Web, le fichier <code>npm/browserify.bundle.js</code> affichera le même résultat que l&#8217;interpréteur Node.</p>
</div>
</div>
<div class="sect2">
<h3 id="_uglify_js">10.5. uglify-js</h3>
<div class="paragraph">
<p><em>uglify-js</em> compile de l&#8217;ECMAScript en ECMAScript mais en plus de concaténer plusieurs fichiers en un seul, il peut également minifier voire supprimer le code inutilisé par votre application.</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/uglify-js" class="bare">npmjs.com/uglify-js</a></span></p>
</div>
<div class="paragraph">
<p><em>ufglify-js</em> s&#8217;utilise via son exécutable, son API Node ou encore via des outils comme Grunt, Gulp ou <em>browserify</em>.
Certaines options vous seront très utiles, comme par exemple :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>--mangle</code> : compresse le code de manière plus agressive en renommant les déclarations pour gagner de la place ;</p>
</li>
<li>
<p><code>--compress</code> : définit des options de compression supplémentaires telles que la suppression des appels à <code>console.log</code> et la suppression du code non-utilisé ;</p>
</li>
<li>
<p><code>--source-map</code> : produit un fichier <em>Source Maps</em> facilitant le débogage du code minifié .</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_templating">11. Templating</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Les librairies de templating proposent chacune à leur manière d&#8217;associer une structure de données à une logique de présentation.</p>
</div>
<div class="paragraph">
<p>Node n&#8217;y échappe pas bien sûr, mais a l&#8217;avantage de disposer de langages de templating fonctionnant aussi bien dans un environnement Node que dans des navigateurs Web.</p>
</div>
<div class="paragraph">
<p>Tous les exemples suivant généreront cette sortie HTML :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;Template demo&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;ul&gt;
&lt;li&gt;CSS maintenables&lt;/li&gt;
&lt;li&gt;Node.js&lt;/li&gt;
&lt;li&gt;Open Sky&lt;/li&gt;
&lt;/ul&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_swig">11.1. swig</h3>
<div class="paragraph">
<p><em>swig</em> est un portage de <em>Twig</em>, bien connu par les développeurs PHP proches de l&#8217;écosystème Symfony.
Sa syntaxe inclut des fonctionnalités comme les filtres, les blocs ou l&#8217;héritage de gabarit.</p>
</div>
<div class="paragraph">
<p>Compatible Node et navigateurs Web.<br>
<span class="URL"><a href="https://npmjs.com/swig" class="bare">npmjs.com/swig</a></span></p>
</div>
<div class="listingblock">
<div class="title">template.swig</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;{{ title | default('Template demo') | capitalize }}&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
{% set items = ['Node.js', 'CSS maintenables', 'Open Sky'] -%}
&lt;ul&gt;
{% for item in items|sort -%}
  &lt;li&gt;{{ item }}&lt;/li&gt;
{% endfor -%}
&lt;/ul&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_handlebars">11.2. handlebars</h3>
<div class="paragraph">
<p><em>handlebars</em> et son prédécesseur <em>mustache</em> sont les vétérans du templating Node.
Leur parti pris est de proposer le minimum de logique afin que celle-ci reste au plus près des données.</p>
</div>
<div class="paragraph">
<p><em>handlebars</em> compile ou précompile les gabarits en des fonctions ECMAScript.</p>
</div>
<div class="paragraph">
<p>Compatible Node et navigateurs Web.<br>
<span class="URL"><a href="https://npmjs.com/handlebars" class="bare">npmjs.com/handlebars</a></span></p>
</div>
<div class="listingblock">
<div class="title">template.hbs</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;{{#if title}}{{title}}{{else}}Template demo{{/if}}&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;ul&gt;
  {{#each items}}
  &lt;li&gt;{{.}}&lt;/li&gt;
  {{/each}}
&lt;/ul&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Cela présuppose que les données adéquates soient passées à la fonction de template <code>Handlebars.template['template.hbs']</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_pug">11.3. pug</h3>
<div class="paragraph">
<p><em>pug</em> s&#8217;inspire de <em>yaml</em> en optant pour un parti pris à base d&#8217;indentation et d&#8217;un balisage dépourvu de chevron.
Son mécanisme de blocs facilite la réutilisation de logiques d&#8217;affichage au sein de votre application.</p>
</div>
<div class="paragraph">
<p>Compatible Node et navigateurs Web .<br>
<span class="URL"><a href="https://npmjs.com/pug" class="bare">npmjs.com/pug</a></span></p>
</div>
<div class="listingblock">
<div class="title">template.pug</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">doctype html
html
  head
    title= title || 'Template demo'
  body
    ul
      each item in ['Node.js', 'CSS maintenables', 'Open Sky']
        li= item</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ejs">11.4. ejs</h3>
<div class="paragraph">
<p><em>ejs</em> part du principe qu&#8217;il n&#8217;y a pas besoin d&#8217;un langage de templating autre qu&#8217;ECMAScript.
Donc c&#8217;est tout simplement ce qui vous sera proposé, impliquant de ce fait une faible courbe d&#8217;apprentissage.</p>
</div>
<div class="paragraph">
<p>Compatible Node et navigateurs Web.<br>
<span class="URL"><a href="https://npmjs.com/ejs" class="bare">npmjs.com/ejs</a></span></p>
</div>
<div class="listingblock">
<div class="title">template.ejs</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;&lt;%= typeof title === 'string' ? title : 'Template demo' %&gt;&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;ul&gt;
  &lt;% ['Node.js', 'CSS maintenables', 'Open Sky'].forEach((item) =&gt; { -%&gt;
  &lt;li&gt;&lt;%= item %&gt;&lt;/li&gt;
  &lt;% }); -%&gt;
&lt;/ul&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_react">11.5. react</h3>
<div class="paragraph">
<p><em>react</em> est une librairie de présentation essentiellement connue pour son approche efficace du côté des navigateurs Web.
Ce qui est moins connu en revanche est sa capacité à pouvoir également générer du balisage côté Node et de servir de moteur de rendu pour des <em>frameworks</em> comme <em>express</em>.</p>
</div>
<div class="paragraph">
<p>Compatible Node et navigateurs Web.<br>
<span class="URL"><a href="https://npmjs.com/react" class="bare">npmjs.com/react</a></span></p>
</div>
<div class="listingblock">
<div class="title">template.jsx</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">'use strict';

const React, { Component } = require('react');

class BookList extends Component {
  render() {
    return (&lt;ul&gt;
      {this.props.books.map((bookName, i) =&gt; (
        &lt;li key={i}&gt;{bookName}&lt;/li&gt;
      ))}
    &lt;/ul&gt;);
  }
}

BookList.defaultProps = {
  books: [],
};

BookList.propTypes = {
  books: React.PropTypes.array,
};

const App = (props) =&gt; {
  return (
    &lt;html&gt;
      &lt;head&gt;
        &lt;title&gt;{props.title || 'Template demo'}&lt;/title&gt;
      &lt;/head&gt;
      &lt;body&gt;
        &lt;BookList books={props.books} /&gt;
      &lt;/body&gt;
    &lt;/html&gt;
  );
};

module.exports = App;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tests">12. Tests</h2>
<div class="sectionbody">
<div class="paragraph">
<p>L&#8217;outillage permettant de tester vos applications est également richement fourni.
Il y a bien sûr de quoi couvrir les tests unitaires, générer des couverture de code, exécuter les tests dans différents navigateurs, tester vos API HTTP ou encore créer des <em>stubs</em> et des <em>mocks</em>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Remarque</span> require('assert')</div>
<div class="paragraph">
<p>Node dispose de sa propre API d&#8217;assertion : vous pouvez donc vous lancer dans vos premiers tests simplement en exécutant un module Node faisant appel à ce module natif.</p>
</div>
<div class="paragraph">
<p>Une exception sera levée à chaque fois qu&#8217;une assertion ne sera pas satisfaite.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="URL"><a href="https://nodejs.org/api/assert.html" class="bare">nodejs.org/api/assert.html</a></span></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_tape">12.1. tape</h3>
<div class="paragraph">
<p><em>tape</em> est probablement la librairie d&#8217;exécution de tests et d&#8217;assertion la plus simple qui soit.
Extrêmement simpliste, elle se base sur la sortie de <code>console.log</code> pour s&#8217;assurer de l&#8217;état global d&#8217;exécution des tests.</p>
</div>
<div class="paragraph">
<p>Compatible Node et navigateurs Web.<br>
<span class="URL"><a href="https://npmjs.com/tape" class="bare">npmjs.com/tape</a></span></p>
</div>
<div class="listingblock">
<div class="title">npm/tape.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">'use strict';

const test = require('tape');

test('Date test', (t) =&gt; {
  t.plan(1);

  t.ok(Date.now() &gt; new Date('2013-03-24').getTime());
});</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sinon">12.2. sinon</h3>
<div class="paragraph">
<p><em>sinon</em> est votre compagnon idéal pour gérer <em>spys</em>, <em>stubs</em> et <em>mocks</em>.
En d&#8217;autres termes, vous prenez la main sur des portions de votre propre API pour vérifier que leur <em>comportement</em> répond comme prévu aux signaux de leur environnement.</p>
</div>
<div class="paragraph">
<p><em>sinon</em> peut étendre <em>chai</em> via le module <em>sinon-chai</em> ou être utilisé directement avec le <em>framework</em> de tests <em>buster</em>.</p>
</div>
<div class="paragraph">
<p>Compatible Node et navigateurs Web.<br>
<span class="URL"><a href="https://npmjs.com/sinon" class="bare">npmjs.com/sinon</a></span></p>
</div>
<div class="listingblock">
<div class="title">npm/sinon.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">'use strict';

const test = require('tape');
const sinon = require('sinon');

test('Date', (t) =&gt; {
  t.plan(3);

  const d = Date;
  const stub = sinon.stub(d, 'now');
  stub.returns(9999999999999);

  d.now();
  t.equal(stub.calledOnce, true);
  t.equal(stub.returnValues[0] &gt; new Date('1983-03-24').getTime(), true);

  stub.returns(100);
  d.now();

  t.equal(stub.returnValues[0] &gt; new Date('1983-03-24').getTime(), true);
});</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_nyc">12.3. nyc</h3>
<div class="paragraph">
<p><em>nyc</em> génère une couverture de code en inspectant le code exécuté par vos tests unitaires.
Les portions de votre applications ignorées par vos tests sont signalées et une exception peut être lancée si un seuil de couverture n&#8217;est pas atteint.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="./images/nyc-cli.png" alt="nyc cli" width="85%">
</div>
<div class="title">Figure 1. Résultat de couverture visualisée dans le terminal</div>
</div>
<div class="paragraph">
<p><em>nyc</em> se greffe sur n&#8217;importe quel librairie d&#8217;exécution de tests et se base sur la librairie <em>istanbul</em> pour calculer la couverture de code.</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/nyc" class="bare">npmjs.com/nyc</a></span><br>
<span class="URL"><a href="https://npmjs.com/istanbul" class="bare">npmjs.com/istanbul</a></span></p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="./images/nyc-web.png" alt="nyc web" width="85%">
</div>
<div class="title">Figure 2. Résultat de couverture visualisée dans un navigateur web</div>
</div>
</div>
<div class="sect2">
<h3 id="_karma">12.4. karma</h3>
<div class="paragraph">
<p><em>karma</em> est un utilitaire d&#8217;exécution de tests unitaires dans un contexte de navigateur Web.
Ces navigateurs peuvent tout aussi bien être ceux présents sur votre machine, que des navigateurs résidant dans une VM ou exécutés à distance via des services comme SauceLabs ou BrowserStack.</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/karma" class="bare">npmjs.com/karma</a></span></p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="./images/karma.png" alt="karma" width="85%">
</div>
<div class="title">Figure 3. Exemple d&#8217;exécution continues de tests avec Karma</div>
</div>
</div>
<div class="sect2">
<h3 id="_supertest">12.5. supertest</h3>
<div class="paragraph">
<p><em>supertest</em> est une librairie de tests pour API HTTP.
Autrement dit, au lieu de tester directement le code de votre application, vous testez le comportement de votre API au travers des codes HTTP et des structures de données exposées.</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/supertest" class="bare">npmjs.com/supertest</a></span></p>
</div>
</div>
<div class="sect2">
<h3 id="_eslint">12.6. eslint</h3>
<div class="paragraph">
<p><em>eslint</em> teste la qualité de votre code et signale des pratiques de programmation à risque.</p>
</div>
<div class="paragraph">
<p>Disponible via une invocation en ligne de commande, libre à vous de paramétrer le comportement du <em>linter</em> selon vos propres règles ou selon des règles pré-établies, partagées sur le registre <em>npm</em>.</p>
</div>
<div class="paragraph">
<p>C&#8217;est un excellent moyen d&#8217;éviter des bugs tout en uniformisant vos pratiques de codage au sein de vos applications.</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/eslint" class="bare">npmjs.com/eslint</a></span></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_automatisation">13. Automatisation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>L&#8217;automatisation de tâches et leur inclusion dans vos projets sont d&#8217;excellents moyens pour rendre explicite votre outillage tout en le rendant reproductible et vérifiable.</p>
</div>
<div class="sect2">
<h3 id="grunt">13.1. grunt</h3>
<div class="paragraph">
<p><em>grunt</em> est l&#8217;outil qui a propulsé Node dans la cour des développeurs <em>frontend</em> (voir <a href="../chapter-04/index.html">../chapter-04/index.html</a>).
Son écosystème de modules particulièrement fourni en terme de performance, d&#8217;assemblage et de fonctionnalités a définitivement aidé de nombreux développeurs à automatiser bon nombre de tâches dans leurs projets.</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/grunt" class="bare">npmjs.com/grunt</a></span> et <span class="URL"><a href="https://npmjs.com/grunt-cli" class="bare">npmjs.com/grunt-cli</a></span></p>
</div>
</div>
<div class="sect2">
<h3 id="gulp">13.2. gulp</h3>
<div class="paragraph">
<p><em>gulp</em> est un outil de <em>build</em> orienté sur l&#8217;enchainement d&#8217;actions pour traiter des ensembles de fichiers.</p>
</div>
<div class="paragraph">
<p>Son architecture entièrement basée sur les <em>Streams</em> rend cette librairie particulièrement rapide et efficace pour les traitements de fichiers impliquant plusieurs étapes de transformation.</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/gulp" class="bare">npmjs.com/gulp</a></span></p>
</div>
<div class="paragraph">
<p>Le concept de <a href="#streams">streams</a> est décrit en fin de chapitre.
Il vous aidera à mieux comprendre les rouages du fonctionnement de <em>Gulp</em>.</p>
</div>
</div>
<div class="sect2">
<h3 id="npm-run-all">13.3. npm-run-all</h3>
<div class="paragraph">
<p><em>npm-run-all</em> est mon outil favori pour composer avec les <em>scripts npm</em>.
Il a l&#8217;avantage d&#8217;être versatile, de permettre de régler finement ce qui doit être exécuté en parallèle ou en série et transfère les options aux sous-scripts.</p>
</div>
<div class="listingblock">
<div class="title">package.npm-run-all.json</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">{
  "scripts": {
    "build": "npm-run-all --parallel 'build:*' --serial start",
    "build:css": "echo 'build css' &amp;&amp; sleep 1",
    "build:js": "echo 'build js' &amp;&amp; sleep 2",
    "start": "echo 'start http server'"
  },
  "dependencies": {
    "npm-run-all": "^4.0.1"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/npm-run-all" class="bare">npmjs.com/npm-run-all</a></span></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_internet_of_things">14. Internet of Things</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_nitrogen">14.1. nitrogen</h3>
<div class="paragraph">
<p><em>nitrogen</em> est une plateforme permettant de gérer les interactions entre différents périphériques, sur un même réseau local et à travers Internet.</p>
</div>
<div class="paragraph">
<p>La librairie se base sur un mécanisme déclaratif de fonctionnalités et de terminaux ainsi que la publication de messages.</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/nitrogen" class="bare">npmjs.com/nitrogen</a></span></p>
</div>
</div>
<div class="sect2">
<h3 id="_serialport">14.2. serialport</h3>
<div class="paragraph">
<p><em>serialport</em> est une librairie pour communiquer avec tout appareil bénéficiant d&#8217;un port série et relié à un périphérique via un port USB.</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/serialport" class="bare">npmjs.com/serialport</a></span></p>
</div>
</div>
<div class="sect2">
<h3 id="_firmata">14.3. firmata</h3>
<div class="paragraph">
<p><em>firmata</em> est un <em>firmware</em>, un protocole de communication ainsi qu&#8217;une librairie de communication pour microcontrôleur Arduino.
Le module Node permet de communiquer via ce protocole avec un Arduino préalablement flashé avec Firmata.</p>
</div>
<div class="paragraph">
<p><span class="URL"><a href="https://npmjs.com/firmata" class="bare">npmjs.com/firmata</a></span></p>
</div>
</div>
<div class="sect2">
<h3 id="_johnny_five">14.4. johnny-five</h3>
<div class="paragraph">
<p><em>johnny-five</em> est une librairie haut niveau pour Arduino, Raspberry Pi et autres microcontrôleurs.
Son API expose des fonctionnalités de manipulations avancées pour simplifier les interactions avec des moteurs, des servo-contrôleurs, des capteurs etc.</p>
</div>
<div class="paragraph">
<p>Compatible Node et navigateurs Web.<br>
<span class="URL"><a href="https://npmjs.com/johnny-five" class="bare">npmjs.com/johnny-five</a></span></p>
</div>
</div>
<div class="sect2">
<h3 id="_cylon">14.5. cylon</h3>
<div class="paragraph">
<p><em>cylon</em> est une autre librairie haut niveau orientée vers la programmation d&#8217;interactions pour robots.
Son interface est particulièrement adaptée pour manipuler et réagir plusieurs robots entre eux.</p>
</div>
<div class="paragraph">
<p>Compatible Node et navigateurs Web.<br>
<span class="URL"><a href="https://npmjs.com/cylon" class="bare">npmjs.com/cylon</a></span></p>
</div>
</div>
<div class="sect2">
<h3 id="_node_red">14.6. node-red</h3>
<div class="paragraph">
<p><em>node-red</em> est une interface visuelle de programmation d&#8217;objets connectés.
Le module Node démarre un serveur web dont l&#8217;interface a pour but de relier des sources de données, des interactions possibles ainsi que les objets devant recevoir les instructions.</p>
</div>
<div class="paragraph">
<p>Compatible Node et navigateurs Web.<br>
<span class="URL"><a href="https://npmjs.com/node-red" class="bare">npmjs.com/node-red</a></span></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_optimisation_des_images">15. Optimisation des images</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>génération de sprites</p>
</li>
<li>
<p>réduction du poid des fichiers</p>
</li>
<li>
<p>génération de vignettes</p>
</li>
<li>
<p>SVG <span class="URL"><a href="https://www.npmjs.com/svgo" class="bare">www.npmjs.com/svgo</a></span></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_optimisation_des_fontes">16. Optimisation des fontes</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>optimisation des chemins</p>
</li>
<li>
<p>iconfontes</p>
</li>
<li>
<p><span class="URL"><a href="https://npmjs.com/connect-fonts" class="bare">npmjs.com/connect-fonts</a></span></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_accessibilité">17. Accessibilité</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>a11y</p>
</li>
<li>
<p>chai-a11y</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_livereload">18. Livereload</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>watcher</p>
</li>
<li>
<p>livereload</p>
</li>
<li>
<p>HMR (Hot Module Replacement)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_rendu_graphique">19. Rendu graphique</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_rendu_2d">19.1. Rendu 2D</h3>
<div class="paragraph">
<p>TBD.</p>
</div>
</div>
<div class="sect2">
<h3 id="_rendu_3d">19.2. Rendu 3D</h3>
<div class="paragraph">
<p>TBD.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_rendu_sonore">20. Rendu sonore</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_codecs">20.1. Codecs</h3>
<div class="paragraph">
<p>TBD.</p>
</div>
</div>
<div class="sect2">
<h3 id="_web_audio">20.2. Web Audio</h3>
<div class="paragraph">
<p>TBD.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2017-09-06 14:02:03 UTC
</div>
</div>
</body>
</html>